@model FloreMoria.Models.Prodotto
@using FloreMoria.Enums
@using System.Text

@{
    ViewBag.Title = "Dettaglio";
    var relatedProd = ViewBag.Related as IEnumerable<FloreMoria.Models.Prodotto>;
    var abbonamenti = ViewBag.Abbonamento as IEnumerable<FloreMoria.Models.Prodotto>;
    var prodottiCarrello = ViewBag.Carrello as IEnumerable<FloreMoria.Dto.DettaglioDto>;
    var apiKey = System.Configuration.ConfigurationManager.AppSettings["ApiKey"];
    var datiEsterni = ViewBag.DatiEsterni as Floremoria.Dto.ExternalDataDto;
}

<style>
    .great-vibes {
    font-family: "Great Vibes", serif;
    font-weight: 400;
    font-style: normal;
    }

    .navbar .navbar-brand,
    .navbar .nav-link {
    color: #369;
    }

    .navbar .nav-link:hover, .cart:hover {
    color: white;
    }

    [x-cloak] {
    display: none;
    }

    .modalBtn{
    display: inline-block;
    width: 50px;
    height: 50px;
    background: white;
    color: #38679D;
    text-align: center;
    font-weight: 700;
    border-radius: 50%;
    cursor: pointer;
    }

    .color:checked + span, input[type = checkbox]:checked + span {
    display: block;
    }

    input::placeholder, textarea::placeholder {
    color: #bfbfbf;
    }
</style>

<div class="py-6 pt-24 mx-7">
    @if (Model.Categoria != Categoria.Abbonamento)
    {
        <div class="max-w-7xl mx-auto lg:px-8 pt-7">
            <div class="mb-7">
                <a href="/Home/Prodotti?section=@Model.Categoria" class="text-[#38679D] flex gap-3 items-center hover:cursor-pointer">
                    <span class="detail rounded-full bg-[#38679D] text-white focus:outline-none w-8 h-8 flex transition duration-300">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="stroke-current m-auto">
                            <line x1="19" y1="12" x2="5" y2="12"></line>
                            <polyline points="12 19 5 12 12 5"></polyline>
                        </svg>
                    </span>
                    Torna alla lista
                </a>
            </div>
            <div class="flex flex-col lg:flex-row -mx-4">
                <div class="lg:flex-1 px-4">
                    <div x-data="{ image: 1, showModal: false, modalImage: 1 }" x-cloak class="relative">
                        <div class="md:h-120 rounded-lg bg-gray-100 mb-4">
                            <div x-show="image === 1" class="md:h-120 rounded-lg bg-gray-100 mb-4 flex items-center justify-center cursor-pointer">
                                <img src="@Model.Immagine" alt="Immagine" class="h-full w-full lg:object-cover rounded-lg" x-on:click="showModal = true; modalImage = 1">
                            </div>
                            <div x-show="image === 2" class="md:h-120 rounded-lg bg-gray-100 mb-4 flex items-center justify-center cursor-pointer">
                                <img src="@Model.Immagine1" alt="Immagine" class="h-full w-full lg:object-cover rounded-lg" x-on:click="showModal = true; modalImage = 2">
                            </div>
                            <div x-show="image === 3" class="md:h-120 rounded-lg bg-gray-100 mb-4 flex items-center justify-center cursor-pointer">
                                <img src="@Model.Immagine2" alt="Immagine" class="h-full w-full lg:object-cover rounded-lg" x-on:click="showModal = true; modalImage = 3">
                            </div>
                            <div x-show="image === 4" class="md:h-120 rounded-lg bg-gray-100 mb-4 flex items-center justify-center cursor-pointer">
                                <img src="@Model.Immagine3" alt="Immagine" class="h-full w-full lg:object-cover rounded-lg" x-on:click="showModal = true; modalImage = 4">
                            </div>
                        </div>
                        <div class="flex -mx-2 mb-4">
                            <div class="flex-1 px-2">
                                <button x-on:click="image = 1" :class="{ 'ring-2 ring-indigo-300 ring-inset': image === 1 }" class="focus:outline-none w-full rounded-lg h-24 md:h-32 bg-gray-100 flex items-center justify-center cursor-pointer overflow-hidden">
                                    <img src="@Model.Immagine" alt="Miniatura 1" class="w-full h-full object-cover p-1 bg-gray-200 rounded-lg">
                                </button>
                            </div>
                            <div class="flex-1 px-2">
                                <button x-on:click="image = 2" :class="{ 'ring-2 ring-indigo-300 ring-inset': image === 2 }" class="focus:outline-none w-full rounded-lg h-24 md:h-32 bg-gray-100 flex items-center justify-center cursor-pointer overflow-hidden">
                                    <img src="@Model.Immagine1" alt="Miniatura 2" class="w-full h-full object-cover p-1 bg-gray-200 rounded-lg">
                                </button>
                            </div>
                            <div class="flex-1 px-2">
                                <button x-on:click="image = 3" :class="{ 'ring-2 ring-indigo-300 ring-inset': image === 3 }" class="focus:outline-none w-full rounded-lg h-24 md:h-32 bg-gray-100 flex items-center justify-center cursor-pointer overflow-hidden">
                                    <img src="@Model.Immagine2" alt="Miniatura 3" class="w-full h-full object-cover p-1 bg-gray-200 rounded-lg">
                                </button>
                            </div>
                            <div class="flex-1 px-2">
                                <button x-on:click="image = 4" :class="{ 'ring-2 ring-indigo-300 ring-inset': image === 4 }" class="focus:outline-none w-full rounded-lg h-24 md:h-32 bg-gray-100 flex items-center justify-center cursor-pointer overflow-hidden">
                                    <img src="@Model.Immagine3" alt="Miniatura 4" class="w-full h-full object-cover p-1 bg-gray-200 rounded-lg">
                                </button>
                            </div>
                        </div>
                        <div x-show="showModal" class="fixed inset-0 z-[1001] flex items-center justify-center bg-gray-800/80">
                            <div class="w-full lg:w-1/3 p-22 md:p-28 lg:p-20">
                                <div class="relative">
                                    <img :src="modalImage === 1 ? '@Model.Immagine' : modalImage === 2 ? '@Model.Immagine1' : modalImage === 3 ? '@Model.Immagine2' : '@Model.Immagine3'" alt="Immagine" class="w-full h-auto rounded-lg ">
                                    <button x-on:click="modalImage = modalImage > 1 ? modalImage - 1 : 4" class="modalBtn absolute -left-20 top-1/2 transform -translate-y-1/2 bg-white py-2 px-5 rounded-full">
                                        &lt;
                                    </button>
                                    <button x-on:click="modalImage = modalImage < 4 ? modalImage + 1 : 1" class="modalBtn absolute -right-20 top-1/2 transform -translate-y-1/2 bg-white py-2 px-5 rounded-full">
                                        &gt;
                                    </button>
                                </div>
                                <button x-on:click="showModal = false" class="mt-4 bg-[#38679D] text-white px-4 py-2 rounded cursor-pointer">Chiudi</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="lg:flex-1 px-4 mb-7 lg:mb-0">
                    <h2 class="mb-2 leading-tight tracking-tight font-bold text-gray-800 text-2xl md:text-3xl">@Model.Nome</h2>

                    <div class="flex items-center space-x-4 my-4">
                        <div>
                            <div class="rounded-lg bg-gray-100 flex py-2 px-3">
                                <span class="font-bold text-[#38679D] text-3xl pl-2">
                                    @if (Model.Prezzo < 10 && Model.Categoria == Categoria.Bouquet)
                                    {
                                        <span>da</span> @Model.Prezzo <span>cad.</span>
                                    }
                                    else
                                    {
                                        @Model.Prezzo
                                    }
                                </span>
                                <span class="text-[#38679D] mr-1 mt-1">€</span>
                            </div>
                        </div>
                    </div>

                    <p class="text-gray-500">@Html.Raw(Model.Descrizione)</p>

                    @if(Model.Categoria == Categoria.Bouquet)
                    {
                        <ul class="space-y-3 mt-3 mb-5">
                            <li class="text-body-color dark:text-dark-6 flex text-base">
                                <span class="text-primary mr-2.5 mt-0.5">
                                    <svg width="20"
                                    height="20"
                                    viewBox="0 0 20 20"
                                    fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                        <g clip-path="url(#clip0_980_24852)">
                                            <path d="M10 0.5625C4.78125 0.5625 0.5625 4.78125 0.5625 10C0.5625 15.2188 4.78125 19.4688 10 19.4688C15.2188 19.4688 19.4688 15.2188 19.4688 10C19.4688 4.78125 15.2188 0.5625 10 0.5625ZM10 18.0625C5.5625 18.0625 1.96875 14.4375 1.96875 10C1.96875 5.5625 5.5625 1.96875 10 1.96875C14.4375 1.96875 18.0625 5.59375 18.0625 10.0312C18.0625 14.4375 14.4375 18.0625 10 18.0625Z"
                                            fill="currentColor" />
                                            <path d="M12.6875 7.09375L8.96875 10.7188L7.28125 9.0625C7 8.78125 6.5625 8.8125 6.28125 9.0625C6 9.34375 6.03125 9.78125 6.28125 10.0625L8.28125 12C8.46875 12.1875 8.71875 12.2813 8.96875 12.2813C9.21875 12.2813 9.46875 12.1875 9.65625 12L13.6875 8.125C13.9688 7.84375 13.9688 7.40625 13.6875 7.125C13.4063 6.84375 12.9688 6.84375 12.6875 7.09375Z"
                                            fill="currentColor" />
                                        </g>
                                        <defs>
                                            <clipPath id="clip0_980_24852">
                                                <rect width="20" height="20" fill="white" />
                                            </clipPath>
                                        </defs>
                                    </svg>
                                </span>
                                <span>
                                    Il Bouquet di fiori freschi, sarà composto dal fiorista in base alla stagione e alla regione di destinazione.
                                </span>
                            </li>
                            <li class="text-body-color dark:text-dark-6 flex text-base">
                                <span class="text-primary mr-2.5 mt-0.5">
                                    <svg width="20"
                                    height="20"
                                    viewBox="0 0 20 20"
                                    fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                        <g clip-path="url(#clip0_980_24852)">
                                            <path d="M10 0.5625C4.78125 0.5625 0.5625 4.78125 0.5625 10C0.5625 15.2188 4.78125 19.4688 10 19.4688C15.2188 19.4688 19.4688 15.2188 19.4688 10C19.4688 4.78125 15.2188 0.5625 10 0.5625ZM10 18.0625C5.5625 18.0625 1.96875 14.4375 1.96875 10C1.96875 5.5625 5.5625 1.96875 10 1.96875C14.4375 1.96875 18.0625 5.59375 18.0625 10.0312C18.0625 14.4375 14.4375 18.0625 10 18.0625Z"
                                            fill="currentColor" />
                                            <path d="M12.6875 7.09375L8.96875 10.7188L7.28125 9.0625C7 8.78125 6.5625 8.8125 6.28125 9.0625C6 9.34375 6.03125 9.78125 6.28125 10.0625L8.28125 12C8.46875 12.1875 8.71875 12.2813 8.96875 12.2813C9.21875 12.2813 9.46875 12.1875 9.65625 12L13.6875 8.125C13.9688 7.84375 13.9688 7.40625 13.6875 7.125C13.4063 6.84375 12.9688 6.84375 12.6875 7.09375Z"
                                            fill="currentColor" />
                                        </g>
                                        <defs>
                                            <clipPath id="clip0_980_24852">
                                                <rect width="20" height="20" fill="white" />
                                            </clipPath>
                                        </defs>
                                    </svg>
                                </span>
                                <span>
                                    Al termine della consegna, ti invieremo una foto della lapide sul tuo telefono come conferma dell'avvenuto servizio.
                                </span>
                            </li>
                            <li class="text-body-color dark:text-dark-6 flex text-base">
                                <span class="text-primary mr-2.5 mt-0.5">
                                    <svg width="20"
                                    height="20"
                                    viewBox="0 0 20 20"
                                    fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                        <g clip-path="url(#clip0_980_24852)">
                                            <path d="M10 0.5625C4.78125 0.5625 0.5625 4.78125 0.5625 10C0.5625 15.2188 4.78125 19.4688 10 19.4688C15.2188 19.4688 19.4688 15.2188 19.4688 10C19.4688 4.78125 15.2188 0.5625 10 0.5625ZM10 18.0625C5.5625 18.0625 1.96875 14.4375 1.96875 10C1.96875 5.5625 5.5625 1.96875 10 1.96875C14.4375 1.96875 18.0625 5.59375 18.0625 10.0312C18.0625 14.4375 14.4375 18.0625 10 18.0625Z"
                                            fill="currentColor" />
                                            <path d="M12.6875 7.09375L8.96875 10.7188L7.28125 9.0625C7 8.78125 6.5625 8.8125 6.28125 9.0625C6 9.34375 6.03125 9.78125 6.28125 10.0625L8.28125 12C8.46875 12.1875 8.71875 12.2813 8.96875 12.2813C9.21875 12.2813 9.46875 12.1875 9.65625 12L13.6875 8.125C13.9688 7.84375 13.9688 7.40625 13.6875 7.125C13.4063 6.84375 12.9688 6.84375 12.6875 7.09375Z"
                                            fill="currentColor" />
                                        </g>
                                        <defs>
                                            <clipPath id="clip0_980_24852">
                                                <rect width="20" height="20" fill="white" />
                                            </clipPath>
                                        </defs>
                                    </svg>
                                </span>
                                <span>
                                    Si prega di notare che i fiori consegnati potrebbero non corrispondere esattamente a quelli mostrati nella foto. Ad ogni modo i nostri fioristi sceglieranno il meglio per il tuo bouquet.
                                </span>
                            </li>
                        </ul>
                    }
                    else if(Model.Categoria == Categoria.Altro || Model.Categoria == Categoria.Lutto && Model.Prezzo < 10)
                    {
                        <ul class="space-y-3 mt-3 mb-5">
                            <li class="text-body-color dark:text-dark-6 flex text-base">
                                <span class="text-primary mr-2.5 mt-0.5">
                                    <svg width="20"
                                    height="20"
                                    viewBox="0 0 20 20"
                                    fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                        <g clip-path="url(#clip0_980_24852)">
                                            <path d="M10 0.5625C4.78125 0.5625 0.5625 4.78125 0.5625 10C0.5625 15.2188 4.78125 19.4688 10 19.4688C15.2188 19.4688 19.4688 15.2188 19.4688 10C19.4688 4.78125 15.2188 0.5625 10 0.5625ZM10 18.0625C5.5625 18.0625 1.96875 14.4375 1.96875 10C1.96875 5.5625 5.5625 1.96875 10 1.96875C14.4375 1.96875 18.0625 5.59375 18.0625 10.0312C18.0625 14.4375 14.4375 18.0625 10 18.0625Z"
                                            fill="currentColor" />
                                            <path d="M12.6875 7.09375L8.96875 10.7188L7.28125 9.0625C7 8.78125 6.5625 8.8125 6.28125 9.0625C6 9.34375 6.03125 9.78125 6.28125 10.0625L8.28125 12C8.46875 12.1875 8.71875 12.2813 8.96875 12.2813C9.21875 12.2813 9.46875 12.1875 9.65625 12L13.6875 8.125C13.9688 7.84375 13.9688 7.40625 13.6875 7.125C13.4063 6.84375 12.9688 6.84375 12.6875 7.09375Z"
                                            fill="currentColor" />
                                        </g>
                                        <defs>
                                            <clipPath id="clip0_980_24852">
                                                <rect width="20" height="20" fill="white" />
                                            </clipPath>
                                        </defs>
                                    </svg>
                                </span>
                                <span>
                                    L'immagine non rappresenta realmente e fedelmente il prodotto che verrà recapitato, ma è solo un esempio.
                                </span>
                            </li>
                            @if (Model.Prezzo != Convert.ToDecimal(3.49))
                            {
                                <li class="text-body-color dark:text-dark-6 flex text-base">
                                    <span class="text-primary mr-2.5 mt-0.5">
                                        <svg width="20"
                                        height="20"
                                        viewBox="0 0 20 20"
                                        fill="none"
                                        xmlns="http://www.w3.org/2000/svg">
                                            <g clip-path="url(#clip0_980_24852)">
                                                <path d="M10 0.5625C4.78125 0.5625 0.5625 4.78125 0.5625 10C0.5625 15.2188 4.78125 19.4688 10 19.4688C15.2188 19.4688 19.4688 15.2188 19.4688 10C19.4688 4.78125 15.2188 0.5625 10 0.5625ZM10 18.0625C5.5625 18.0625 1.96875 14.4375 1.96875 10C1.96875 5.5625 5.5625 1.96875 10 1.96875C14.4375 1.96875 18.0625 5.59375 18.0625 10.0312C18.0625 14.4375 14.4375 18.0625 10 18.0625Z"
                                                fill="currentColor" />
                                                <path d="M12.6875 7.09375L8.96875 10.7188L7.28125 9.0625C7 8.78125 6.5625 8.8125 6.28125 9.0625C6 9.34375 6.03125 9.78125 6.28125 10.0625L8.28125 12C8.46875 12.1875 8.71875 12.2813 8.96875 12.2813C9.21875 12.2813 9.46875 12.1875 9.65625 12L13.6875 8.125C13.9688 7.84375 13.9688 7.40625 13.6875 7.125C13.4063 6.84375 12.9688 6.84375 12.6875 7.09375Z"
                                                fill="currentColor" />
                                            </g>
                                            <defs>
                                                <clipPath id="clip0_980_24852">
                                                    <rect width="20" height="20" fill="white" />
                                                </clipPath>
                                            </defs>
                                        </svg>
                                    </span>
                                    <span>
                                        Questo prodotto è personalizzabile con il testo da te scelto.
                                    </span>
                                </li>
                            }
                            @if(Model.Prezzo < 15)
                            {
                                <li class="text-body-color dark:text-dark-6 flex text-base">
                                    <span class="text-primary mr-2.5 mt-0.5">
                                        <svg width="20"
                                        height="20"
                                        viewBox="0 0 20 20"
                                        fill="none"
                                        xmlns="http://www.w3.org/2000/svg">
                                            <g clip-path="url(#clip0_980_24852)">
                                                <path d="M10 0.5625C4.78125 0.5625 0.5625 4.78125 0.5625 10C0.5625 15.2188 4.78125 19.4688 10 19.4688C15.2188 19.4688 19.4688 15.2188 19.4688 10C19.4688 4.78125 15.2188 0.5625 10 0.5625ZM10 18.0625C5.5625 18.0625 1.96875 14.4375 1.96875 10C1.96875 5.5625 5.5625 1.96875 10 1.96875C14.4375 1.96875 18.0625 5.59375 18.0625 10.0312C18.0625 14.4375 14.4375 18.0625 10 18.0625Z"
                                                fill="currentColor" />
                                                <path d="M12.6875 7.09375L8.96875 10.7188L7.28125 9.0625C7 8.78125 6.5625 8.8125 6.28125 9.0625C6 9.34375 6.03125 9.78125 6.28125 10.0625L8.28125 12C8.46875 12.1875 8.71875 12.2813 8.96875 12.2813C9.21875 12.2813 9.46875 12.1875 9.65625 12L13.6875 8.125C13.9688 7.84375 13.9688 7.40625 13.6875 7.125C13.4063 6.84375 12.9688 6.84375 12.6875 7.09375Z"
                                                fill="currentColor" />
                                            </g>
                                            <defs>
                                                <clipPath id="clip0_980_24852">
                                                    <rect width="20" height="20" fill="white" />
                                                </clipPath>
                                            </defs>
                                        </svg>
                                    </span>
                                    <span>
                                        Acquistabile solo in abbinamento ad un bouquet.
                                    </span>
                                </li>
                            }
                        </ul>
                    }

                    @if (Model.Categoria == Categoria.Lutto && Model.Prezzo > 30)
                    {
                        <ul class="space-y-3 mt-3 mb-5">
                            <li class="text-body-color dark:text-dark-6 flex text-base">
                                <span class="text-primary mr-2.5 mt-0.5">
                                    <svg width="20"
                                    height="20"
                                    viewBox="0 0 20 20"
                                    fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                        <g clip-path="url(#clip0_980_24852)">
                                            <path d="M10 0.5625C4.78125 0.5625 0.5625 4.78125 0.5625 10C0.5625 15.2188 4.78125 19.4688 10 19.4688C15.2188 19.4688 19.4688 15.2188 19.4688 10C19.4688 4.78125 15.2188 0.5625 10 0.5625ZM10 18.0625C5.5625 18.0625 1.96875 14.4375 1.96875 10C1.96875 5.5625 5.5625 1.96875 10 1.96875C14.4375 1.96875 18.0625 5.59375 18.0625 10.0312C18.0625 14.4375 14.4375 18.0625 10 18.0625Z"
                                            fill="currentColor" />
                                            <path d="M12.6875 7.09375L8.96875 10.7188L7.28125 9.0625C7 8.78125 6.5625 8.8125 6.28125 9.0625C6 9.34375 6.03125 9.78125 6.28125 10.0625L8.28125 12C8.46875 12.1875 8.71875 12.2813 8.96875 12.2813C9.21875 12.2813 9.46875 12.1875 9.65625 12L13.6875 8.125C13.9688 7.84375 13.9688 7.40625 13.6875 7.125C13.4063 6.84375 12.9688 6.84375 12.6875 7.09375Z"
                                            fill="currentColor" />
                                        </g>
                                        <defs>
                                            <clipPath id="clip0_980_24852">
                                                <rect width="20" height="20" fill="white" />
                                            </clipPath>
                                        </defs>
                                    </svg>
                                </span>
                                <span>
                                    Puoi personalizzare la composizione scegliendo i colori dei fiori preferiti e adattandolo al genere del defunto, rendendo così il tuo omaggio ancora più significativo.
                                </span>
                            </li>
                            <li class="text-body-color dark:text-dark-6 flex text-base">
                                <span class="text-primary mr-2.5 mt-0.5">
                                    <svg width="20"
                                    height="20"
                                    viewBox="0 0 20 20"
                                    fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                        <g clip-path="url(#clip0_980_24852)">
                                            <path d="M10 0.5625C4.78125 0.5625 0.5625 4.78125 0.5625 10C0.5625 15.2188 4.78125 19.4688 10 19.4688C15.2188 19.4688 19.4688 15.2188 19.4688 10C19.4688 4.78125 15.2188 0.5625 10 0.5625ZM10 18.0625C5.5625 18.0625 1.96875 14.4375 1.96875 10C1.96875 5.5625 5.5625 1.96875 10 1.96875C14.4375 1.96875 18.0625 5.59375 18.0625 10.0312C18.0625 14.4375 14.4375 18.0625 10 18.0625Z"
                                            fill="currentColor" />
                                            <path d="M12.6875 7.09375L8.96875 10.7188L7.28125 9.0625C7 8.78125 6.5625 8.8125 6.28125 9.0625C6 9.34375 6.03125 9.78125 6.28125 10.0625L8.28125 12C8.46875 12.1875 8.71875 12.2813 8.96875 12.2813C9.21875 12.2813 9.46875 12.1875 9.65625 12L13.6875 8.125C13.9688 7.84375 13.9688 7.40625 13.6875 7.125C13.4063 6.84375 12.9688 6.84375 12.6875 7.09375Z"
                                            fill="currentColor" />
                                        </g>
                                        <defs>
                                            <clipPath id="clip0_980_24852">
                                                <rect width="20" height="20" fill="white" />
                                            </clipPath>
                                        </defs>
                                    </svg>
                                </span>
                                <span>
                                    Possiamo consegnarla presso l'indirizzo da te scelto o direttamente sul luogo della cerimonia, assicurando un gesto di affetto e rispetto nel momento del commiato.
                                </span>
                            </li>
                            <li class="text-body-color dark:text-dark-6 flex text-base">
                                <span class="text-primary mr-2.5 mt-0.5">
                                    <svg width="20"
                                    height="20"
                                    viewBox="0 0 20 20"
                                    fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                        <g clip-path="url(#clip0_980_24852)">
                                            <path d="M10 0.5625C4.78125 0.5625 0.5625 4.78125 0.5625 10C0.5625 15.2188 4.78125 19.4688 10 19.4688C15.2188 19.4688 19.4688 15.2188 19.4688 10C19.4688 4.78125 15.2188 0.5625 10 0.5625ZM10 18.0625C5.5625 18.0625 1.96875 14.4375 1.96875 10C1.96875 5.5625 5.5625 1.96875 10 1.96875C14.4375 1.96875 18.0625 5.59375 18.0625 10.0312C18.0625 14.4375 14.4375 18.0625 10 18.0625Z"
                                            fill="currentColor" />
                                            <path d="M12.6875 7.09375L8.96875 10.7188L7.28125 9.0625C7 8.78125 6.5625 8.8125 6.28125 9.0625C6 9.34375 6.03125 9.78125 6.28125 10.0625L8.28125 12C8.46875 12.1875 8.71875 12.2813 8.96875 12.2813C9.21875 12.2813 9.46875 12.1875 9.65625 12L13.6875 8.125C13.9688 7.84375 13.9688 7.40625 13.6875 7.125C13.4063 6.84375 12.9688 6.84375 12.6875 7.09375Z"
                                            fill="currentColor" />
                                        </g>
                                        <defs>
                                            <clipPath id="clip0_980_24852">
                                                <rect width="20" height="20" fill="white" />
                                            </clipPath>
                                        </defs>
                                    </svg>
                                </span>
                                <span>
                                    Al termine della consegna, ti invieremo una foto sul tuo telefono come conferma dell'avvenuto servizio.
                                </span>
                            </li>
                            <li class="text-body-color dark:text-dark-6 flex text-base">
                                <span class="text-primary mr-2.5 mt-0.5">
                                    <svg width="20"
                                    height="20"
                                    viewBox="0 0 20 20"
                                    fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                        <g clip-path="url(#clip0_980_24852)">
                                            <path d="M10 0.5625C4.78125 0.5625 0.5625 4.78125 0.5625 10C0.5625 15.2188 4.78125 19.4688 10 19.4688C15.2188 19.4688 19.4688 15.2188 19.4688 10C19.4688 4.78125 15.2188 0.5625 10 0.5625ZM10 18.0625C5.5625 18.0625 1.96875 14.4375 1.96875 10C1.96875 5.5625 5.5625 1.96875 10 1.96875C14.4375 1.96875 18.0625 5.59375 18.0625 10.0312C18.0625 14.4375 14.4375 18.0625 10 18.0625Z"
                                            fill="currentColor" />
                                            <path d="M12.6875 7.09375L8.96875 10.7188L7.28125 9.0625C7 8.78125 6.5625 8.8125 6.28125 9.0625C6 9.34375 6.03125 9.78125 6.28125 10.0625L8.28125 12C8.46875 12.1875 8.71875 12.2813 8.96875 12.2813C9.21875 12.2813 9.46875 12.1875 9.65625 12L13.6875 8.125C13.9688 7.84375 13.9688 7.40625 13.6875 7.125C13.4063 6.84375 12.9688 6.84375 12.6875 7.09375Z"
                                            fill="currentColor" />
                                        </g>
                                        <defs>
                                            <clipPath id="clip0_980_24852">
                                                <rect width="20" height="20" fill="white" />
                                            </clipPath>
                                        </defs>
                                    </svg>
                                </span>
                                <span>
                                    Si prega di notare che i fiori consegnati potrebbero non corrispondere esattamente a quelli mostrati nella foto. Ad ogni modo i nostri fioristi sceglieranno il meglio per il tuo bouquet.
                                </span>
                            </li>
                        </ul>
                    }
                </div>
            </div>
            @if (Model.Categoria != Categoria.Carnet || Model.Categoria != Categoria.Altro)
            {
                <form class="w-full mx-auto mb-5 grid grid-cols-1 lg:grid-cols-2 gap-7 lg:gap-12">
                    @*@if(Model.Prezzo > 25)
                    {                      
                        <fieldset class="space-y-6">
                            <div class="py-4 border-b border-gray-300">
                                <h3 class="text-2xl text-gray-700 mr-4">Fiori</h3>
                            </div>
                            <div class="w-full">
                                <div>
                                    <textarea id="flowerArea" rows="3" placeholder="Tipo di fiori che vuoi nella composizione" class="w-full bg-transparent rounded-md border-2 border-stroke border-gray-300 dark:border-dark-3 p-5 text-dark-6 outline-none transition focus:border-[#38679D] active:border-[#38679D] disabled:cursor-default disabled:bg-gray-2"></textarea>
                                </div>
                            </div>
                        </fieldset>
                    }*@
                    @if(Model.Categoria == Categoria.Altro && Model.Prezzo < 3 || Model.Categoria == Categoria.Lutto && Model.Prezzo < 5)
                    {
                        <fieldset class="space-y-6">
                            <div class="py-4 border-b border-gray-300">
                                <h3 class="text-2xl text-gray-700 mr-4">
                                    Messaggio 
                                    <select id="wordLimit" class=" ms-5 text-base self-baseline cursor-pointer appearance-none rounded-xl border border-gray-200 px-3 text-center grow lg:grow-0">
                                        <option value="10" data-price="@(Model.Prezzo * 1)">10 parole - @(Model.Prezzo * 1)€</option>
                                        <option value="20" data-price="@(Model.Prezzo * 2)">20 parole - @(Model.Prezzo * 2)€</option>
                                        <option value="30" data-price="@(Model.Prezzo * 3)">30 parole - @(Model.Prezzo * 3)€</option>
                                        <option value="40" data-price="@(Model.Prezzo * 4)">40 parole - @(Model.Prezzo * 4)€</option>
                                        <option value="50" data-price="@(Model.Prezzo * 5)">50 parole - @(Model.Prezzo * 5)€</option>
                                        <option value="90" data-price="@(Model.Prezzo * 9)">Pagina intera - @(Model.Prezzo * 9)€</option>
                                    </select>
                                </h3>
                            </div>
                            <div class="w-full">
                                <div>
                                    <textarea id="messageArea"  rows="3" placeholder="Il tuo messaggio" class="w-full bg-transparent rounded-md border-2 border-stroke border-gray-300 dark:border-dark-3 p-5 text-dark-6 outline-none transition focus:border-[#38679D] active:border-[#38679D] disabled:cursor-default disabled:bg-gray-2"></textarea>
                                </div>
                            </div>
                        </fieldset>
                    }
                    else if (Model.Categoria == Categoria.Lutto && Model.Prezzo > 10 && Model.Prezzo < 15)
                    {
                        <fieldset class="space-y-6">
                            <div class="py-4 border-b border-gray-300">
                                <h3 class="text-2xl text-gray-700 mr-4">Messaggio</h3>
                            </div>
                            <div class="w-full">
                                <div>
                                    <textarea id="messageArea2" rows="3" placeholder="Il tuo messaggio" class="w-full bg-transparent rounded-md border-2 border-stroke border-gray-300 dark:border-dark-3 p-5 text-dark-6 outline-none transition focus:border-[#38679D] active:border-[#38679D] disabled:cursor-default disabled:bg-gray-2"></textarea>
                                </div>
                            </div>
                        </fieldset>
                    }
                    @if(Model.Prezzo > 5)
                    {
                        <div></div>
                    }
                    <span class="grid grid-cols-1 gap-5">
                        @if(Model.Categoria == Categoria.Bouquet && Model.Prezzo > 30 && Model.Prezzo < 39)
                        {                      
                            <fieldset class="space-y-6">
                                <div class="py-4 border-b border-gray-300 mb-[1.1em]">
                                    <legend class="text-2xl text-gray-700 mr-4">Colore (facoltativo)</legend>
                                </div>
                                <div class="grid grid-cols-3 lg:grid-cols-5 gap-5">
                                    <label for="bianco" class="relative flex flex-col bg-white p-5 rounded-lg shadow-md cursor-pointer">
                                        <span class="h-6 w-6 border">
                                        </span>
                                        <input type="radio" name="color" id="bianco" value="@Colore.Bianco" class="color absolute h-0 w-0 appearance-none" />
                                        <span aria-hidden="true" class="hidden absolute inset-0 border-2 border-[#38679D] rounded-lg">
                                            <span class="absolute top-1/2 -translate-y-1/2 right-4 h-6 w-6 inline-flex items-center justify-center rounded-full bg-[#38679D]/90">
                                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-5 w-5 text-white">
                                                    <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                                                </svg>
                                            </span>
                                        </span>
                                    </label>
                                    <label for="rosa" class="relative flex flex-col bg-white p-5 rounded-lg shadow-md cursor-pointer">
                                        <span class="h-6 w-6 bg-rose-200">
                                        </span>
                                        <input type="radio" name="color" id="rosa" value="@Colore.Rosa" class="color absolute h-0 w-0 appearance-none" />
                                        <span aria-hidden="true" class="hidden absolute inset-0 border-2 border-[#38679D] rounded-lg">
                                            <span class="absolute top-1/2 -translate-y-1/2 right-4 h-6 w-6 inline-flex items-center justify-center rounded-full bg-[#38679D]/90">
                                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-5 w-5 text-white">
                                                    <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                                                </svg>
                                            </span>
                                        </span>
                                    </label>
                                    <label for="rosso" class="relative flex flex-col bg-white p-5 rounded-lg shadow-md cursor-pointer">
                                        <span class="h-6 w-6 bg-red-400">
                                        </span>
                                        <input type="radio" name="color" id="rosso" value="@Colore.Rosso" class="color absolute h-0 w-0 appearance-none" />
                                        <span aria-hidden="true" class="hidden absolute inset-0 border-2 border-[#38679D] rounded-lg">
                                            <span class="absolute top-1/2 -translate-y-1/2 right-4 h-6 w-6 inline-flex items-center justify-center rounded-full bg-[#38679D]/90">
                                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-5 w-5 text-white">
                                                    <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                                                </svg>
                                            </span>
                                        </span>
                                    </label>
                                    <label for="arancione" class="relative flex flex-col bg-white p-5 rounded-lg shadow-md cursor-pointer">
                                        <span class="h-6 w-6 bg-orange-400">
                                        </span>
                                        <input type="radio" name="color" id="arancione" value="@Colore.Arancione" class="color absolute h-0 w-0 appearance-none" />
                                        <span aria-hidden="true" class="hidden absolute inset-0 border-2 border-[#38679D] rounded-lg">
                                            <span class="absolute top-1/2 -translate-y-1/2 right-4 h-6 w-6 inline-flex items-center justify-center rounded-full bg-[#38679D]/90">
                                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-5 w-5 text-white">
                                                    <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                                                </svg>
                                            </span>
                                        </span>
                                    </label>
                                    <label for="giallo" class="relative flex flex-col bg-white p-5 rounded-lg shadow-md cursor-pointer">
                                        <span class="h-6 w-6 bg-yellow-400">
                                        </span>
                                        <input type="radio" name="color" id="giallo" value="@Colore.Giallo" class="color absolute h-0 w-0 appearance-none" />
                                        <span aria-hidden="true" class="hidden absolute inset-0 border-2 border-[#38679D] rounded-lg">
                                            <span class="absolute top-1/2 -translate-y-1/2 right-4 h-6 w-6 inline-flex items-center justify-center rounded-full bg-[#38679D]/90">
                                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-5 w-5 text-white">
                                                    <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                                                </svg>
                                            </span>
                                        </span>
                                    </label>
                                </div>
                            </fieldset>
                        }

                        <fieldset class="space-y-6">
                            <div class="py-4 border-b border-gray-300">
                                <legend class="text-2xl text-gray-700 mr-4">Quantità</legend>
                            </div>
                            @if (Model.Prezzo < 10 && Model.Categoria == 0)
                            {
                                <select id="quantity" class="cursor-pointer appearance-none rounded-xl border-2 border-gray-300 text-center p-3 w-full shadow-md">
                                    <option value="">-- Seleziona Qtà --</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                </select>
                            }
                            else
                            {
                                <select id="quantity" class="cursor-pointer appearance-none rounded-xl border-2 border-gray-300 text-center p-3 w-full shadow-md">
                                    <option value="">-- Seleziona Qtà --</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                </select>
                            }
                        </fieldset>
                    </span>
                </form>
            }
        </div>
    }
    else
    {
        <div class="max-w-7xl mx-auto lg:px-8 pt-7">
            <div class="mb-7">
                <a href="/Home/Prodotti?section=@Model.Categoria" class="text-[#38679D] flex gap-3 items-center hover:cursor-pointer">
                    <span class="detail rounded-full bg-[#38679D] text-white focus:outline-none w-8 h-8 flex transition duration-300">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="stroke-current m-auto">
                            <line x1="19" y1="12" x2="5" y2="12"></line>
                            <polyline points="12 19 5 12 12 5"></polyline>
                        </svg>
                    </span>
                    Torna alla lista
                </a>
            </div>
            <div class="-mx-4">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-9 px-4">
                    <div class="h-64 md:h-120 rounded-lg bg-gray-100 mb-4">
                        <img src="@Model.Immagine" alt="Immagine" class="h-full w-full object-cover rounded-lg">
                    </div>
                    <div>
                        <h2 class="mb-2 leading-tight tracking-tight font-bold text-gray-800 text-2xl md:text-3xl">@Model.Nome</h2>

                        <p class="text-gray-500">@Html.Raw(Model.Descrizione)</p>
                        <ul class="space-y-3 mt-3 mb-5">
                            <li class="text-body-color dark:text-dark-6 flex text-base">
                                <span class="text-primary mr-2.5 mt-0.5">
                                    <svg width="20"
                                    height="20"
                                    viewBox="0 0 20 20"
                                    fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                        <g clip-path="url(#clip0_980_24852)">
                                            <path d="M10 0.5625C4.78125 0.5625 0.5625 4.78125 0.5625 10C0.5625 15.2188 4.78125 19.4688 10 19.4688C15.2188 19.4688 19.4688 15.2188 19.4688 10C19.4688 4.78125 15.2188 0.5625 10 0.5625ZM10 18.0625C5.5625 18.0625 1.96875 14.4375 1.96875 10C1.96875 5.5625 5.5625 1.96875 10 1.96875C14.4375 1.96875 18.0625 5.59375 18.0625 10.0312C18.0625 14.4375 14.4375 18.0625 10 18.0625Z"
                                            fill="currentColor" />
                                            <path d="M12.6875 7.09375L8.96875 10.7188L7.28125 9.0625C7 8.78125 6.5625 8.8125 6.28125 9.0625C6 9.34375 6.03125 9.78125 6.28125 10.0625L8.28125 12C8.46875 12.1875 8.71875 12.2813 8.96875 12.2813C9.21875 12.2813 9.46875 12.1875 9.65625 12L13.6875 8.125C13.9688 7.84375 13.9688 7.40625 13.6875 7.125C13.4063 6.84375 12.9688 6.84375 12.6875 7.09375Z"
                                            fill="currentColor" />
                                        </g>
                                        <defs>
                                            <clipPath id="clip0_980_24852">
                                                <rect width="20" height="20" fill="white" />
                                            </clipPath>
                                        </defs>
                                    </svg>
                                </span>
                                <span>
                                    Scegli le date di consegna quando vuoi senza scadenza.
                                </span>
                            </li>
                            <li class="text-body-color dark:text-dark-6 flex text-base">
                                <span class="text-primary mr-2.5 mt-0.5">
                                    <svg width="20"
                                    height="20"
                                    viewBox="0 0 20 20"
                                    fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                        <g clip-path="url(#clip0_980_24852)">
                                            <path d="M10 0.5625C4.78125 0.5625 0.5625 4.78125 0.5625 10C0.5625 15.2188 4.78125 19.4688 10 19.4688C15.2188 19.4688 19.4688 15.2188 19.4688 10C19.4688 4.78125 15.2188 0.5625 10 0.5625ZM10 18.0625C5.5625 18.0625 1.96875 14.4375 1.96875 10C1.96875 5.5625 5.5625 1.96875 10 1.96875C14.4375 1.96875 18.0625 5.59375 18.0625 10.0312C18.0625 14.4375 14.4375 18.0625 10 18.0625Z"
                                            fill="currentColor" />
                                            <path d="M12.6875 7.09375L8.96875 10.7188L7.28125 9.0625C7 8.78125 6.5625 8.8125 6.28125 9.0625C6 9.34375 6.03125 9.78125 6.28125 10.0625L8.28125 12C8.46875 12.1875 8.71875 12.2813 8.96875 12.2813C9.21875 12.2813 9.46875 12.1875 9.65625 12L13.6875 8.125C13.9688 7.84375 13.9688 7.40625 13.6875 7.125C13.4063 6.84375 12.9688 6.84375 12.6875 7.09375Z"
                                            fill="currentColor" />
                                        </g>
                                        <defs>
                                            <clipPath id="clip0_980_24852">
                                                <rect width="20" height="20" fill="white" />
                                            </clipPath>
                                        </defs>
                                    </svg>
                                </span>
                                <span>
                                    Se la data scelta non è disponibile la consegna verrà effettuata il giorno precedente o successivo.
                                </span>
                            </li>
                            <li class="text-body-color dark:text-dark-6 flex text-base">
                                <span class="text-primary mr-2.5 mt-0.5">
                                    <svg width="20"
                                    height="20"
                                    viewBox="0 0 20 20"
                                    fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                        <g clip-path="url(#clip0_980_24852)">
                                            <path d="M10 0.5625C4.78125 0.5625 0.5625 4.78125 0.5625 10C0.5625 15.2188 4.78125 19.4688 10 19.4688C15.2188 19.4688 19.4688 15.2188 19.4688 10C19.4688 4.78125 15.2188 0.5625 10 0.5625ZM10 18.0625C5.5625 18.0625 1.96875 14.4375 1.96875 10C1.96875 5.5625 5.5625 1.96875 10 1.96875C14.4375 1.96875 18.0625 5.59375 18.0625 10.0312C18.0625 14.4375 14.4375 18.0625 10 18.0625Z"
                                            fill="currentColor" />
                                            <path d="M12.6875 7.09375L8.96875 10.7188L7.28125 9.0625C7 8.78125 6.5625 8.8125 6.28125 9.0625C6 9.34375 6.03125 9.78125 6.28125 10.0625L8.28125 12C8.46875 12.1875 8.71875 12.2813 8.96875 12.2813C9.21875 12.2813 9.46875 12.1875 9.65625 12L13.6875 8.125C13.9688 7.84375 13.9688 7.40625 13.6875 7.125C13.4063 6.84375 12.9688 6.84375 12.6875 7.09375Z"
                                            fill="currentColor" />
                                        </g>
                                        <defs>
                                            <clipPath id="clip0_980_24852">
                                                <rect width="20" height="20" fill="white" />
                                            </clipPath>
                                        </defs>
                                    </svg>
                                </span>
                                <span>
                                    Paga in un'unica soluzione <b>scontata</b> o mensilmente.
                                </span>
                            </li>
                            <li class="text-body-color dark:text-dark-6 flex text-base">
                                <span class="text-primary mr-2.5 mt-0.5">
                                    <svg width="20"
                                    height="20"
                                    viewBox="0 0 20 20"
                                    fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                        <g clip-path="url(#clip0_980_24852)">
                                            <path d="M10 0.5625C4.78125 0.5625 0.5625 4.78125 0.5625 10C0.5625 15.2188 4.78125 19.4688 10 19.4688C15.2188 19.4688 19.4688 15.2188 19.4688 10C19.4688 4.78125 15.2188 0.5625 10 0.5625ZM10 18.0625C5.5625 18.0625 1.96875 14.4375 1.96875 10C1.96875 5.5625 5.5625 1.96875 10 1.96875C14.4375 1.96875 18.0625 5.59375 18.0625 10.0312C18.0625 14.4375 14.4375 18.0625 10 18.0625Z"
                                            fill="currentColor" />
                                            <path d="M12.6875 7.09375L8.96875 10.7188L7.28125 9.0625C7 8.78125 6.5625 8.8125 6.28125 9.0625C6 9.34375 6.03125 9.78125 6.28125 10.0625L8.28125 12C8.46875 12.1875 8.71875 12.2813 8.96875 12.2813C9.21875 12.2813 9.46875 12.1875 9.65625 12L13.6875 8.125C13.9688 7.84375 13.9688 7.40625 13.6875 7.125C13.4063 6.84375 12.9688 6.84375 12.6875 7.09375Z"
                                            fill="currentColor" />
                                        </g>
                                        <defs>
                                            <clipPath id="clip0_980_24852">
                                                <rect width="20" height="20" fill="white" />
                                            </clipPath>
                                        </defs>
                                    </svg>
                                </span>
                                <span>
                                    Puoi disdire l'abbonamento quando vuoi.
                                </span>
                            </li>
                        </ul>
                    </div>
                </div>
                @{
                    if(Model.Categoria == Categoria.Abbonamento)
                    {
                        var datePickerNumber = Convert.ToInt32(Model.Nome.Split(' ')[1]);
                        <div class="px-4">
                            <form class="w-full mb-5 mt-7">
                                <fieldset class="space-y-6">
                                    <div class="py-4 border-b border-gray-300">
                                        <legend class="text-2xl text-gray-700 mr-4">Prodotti</legend>
                                    </div>
                                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-5">
                                        @foreach (var item in abbonamenti.OrderBy(x => x.Categoria).ThenBy(x => x.Prezzo))
                                        {
                                            <label for="@item.Id" class="relative flex flex-col bg-white p-5 rounded-lg shadow-md cursor-pointer">
                                                <span>
                                                    @item.Nome - @(item.Prezzo * Model.NumeroConsegneAbbonamento)€
                                                </span>
                                                <input type="checkbox" id="@item.Id" data-id="@item.Id" data-price="@item.Prezzo" data-category="@Html.Raw(Json.Encode(item.Categoria))" data-nome="@item.Nome" class="absolute h-0 w-0 appearance-none product-checkbox" />
                                                <span aria-hidden="true" class="hidden absolute inset-0 border-2 border-[#38679D] rounded-lg">
                                                    <span class="absolute top-1/2 -translate-y-1/2 right-4 h-6 w-6 inline-flex items-center justify-center rounded-full bg-[#38679D]/90">
                                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-5 w-5 text-white">
                                                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                                                        </svg>
                                                    </span>
                                                </span>
                                            </label>
                                        }
                                    </div>
                                    <p class="text-base"><i class="fas fa-info-circle"></i> Lo sconto verrà applicato direttamente al carrello scegliendo il pagamento in soluzione unica.</p>
                                </fieldset>
                            </form>
                            @if(datePickerNumber < 52)
                            {
                                <div class="py-4 border-b border-gray-300 mt-12">
                                    <legend class="text-2xl text-gray-700 mr-4">Date</legend>
                                </div>
                                <div class="mt-7 grid grid-cols-1 lg:grid-cols-3 gap-5">
                                    @for (int i = 0; i < datePickerNumber; i++)
                                    {
                                        <!-- ====== Date Picker Start -->
                                        <section class="bg-white dark:bg-dark">
                                            <div class="container">
                                                <div class="mx-auto w-full">
                                                    <div class="relative mb-3">
                                                        <input id="datepicker_@i"
                                                               type="text"
                                                               placeholder="Seleziona una data"
                                                               class="datepicker h-12 w-full appearance-none rounded-lg border border-stroke bg-white pl-12 pr-4 text-dark outline-none focus:border-primary dark:border-dark-3 dark:bg-dark-2 dark:text-white"
                                                               required />
                                                        <span id="toggleDatepicker_@i"
                                                              class="absolute inset-y-0 flex h-12 w-12 items-center justify-center text-dark-5">
                                                            <svg width="21"
                                                                 height="20"
                                                                 viewBox="0 0 21 20"
                                                                 fill="none"
                                                                 xmlns="http://www.w3.org/2000/svg">
                                                                <path d="M18 3.3125H16.3125V2.625C16.3125 2.25 16 1.90625 15.5937 1.90625C15.1875 1.90625 14.875 2.21875 14.875 2.625V3.28125H6.09375V2.625C6.09375 2.25 5.78125 1.90625 5.375 1.90625C4.96875 1.90625 4.65625 2.21875 4.65625 2.625V3.28125H3C1.9375 3.28125 1.03125 4.15625 1.03125 5.25V16.125C1.03125 17.1875 1.90625 18.0938 3 18.0938H18C19.0625 18.0938 19.9687 17.2187 19.9687 16.125V5.25C19.9687 4.1875 19.0625 3.3125 18 3.3125ZM3 4.71875H4.6875V5.34375C4.6875 5.71875 5 6.0625 5.40625 6.0625C5.8125 6.0625 6.125 5.75 6.125 5.34375V4.71875H14.9687V5.34375C14.9687 5.71875 15.2812 6.0625 15.6875 6.0625C16.0937 6.0625 16.4062 5.75 16.4062 5.34375V4.71875H18C18.3125 4.71875 18.5625 4.96875 18.5625 5.28125V7.34375H2.46875V5.28125C2.46875 4.9375 2.6875 4.71875 3 4.71875ZM18 16.6562H3C2.6875 16.6562 2.4375 16.4062 2.4375 16.0937V8.71875H18.5312V16.125C18.5625 16.4375 18.3125 16.6562 18 16.6562Z"
                                                                      fill="currentColor" />
                                                                <path d="M9.5 9.59375H8.8125C8.625 9.59375 8.5 9.71875 8.5 9.90625V10.5938C8.5 10.7812 8.625 10.9062 8.8125 10.9062H9.5C9.6875 10.9062 9.8125 10.7812 9.8125 10.5938V9.90625C9.8125 9.71875 9.65625 9.59375 9.5 9.59375Z"
                                                                      fill="currentColor" />
                                                                <path d="M12.3438 9.59375H11.6562C11.4687 9.59375 11.3438 9.71875 11.3438 9.90625V10.5938C11.3438 10.7812 11.4687 10.9062 11.6562 10.9062H12.3438C12.5312 10.9062 12.6562 10.7812 12.6562 10.5938V9.90625C12.6562 9.71875 12.5312 9.59375 12.3438 9.59375Z"
                                                                      fill="currentColor" />
                                                                <path d="M15.1875 9.59375H14.5C14.3125 9.59375 14.1875 9.71875 14.1875 9.90625V10.5938C14.1875 10.7812 14.3125 10.9062 14.5 10.9062H15.1875C15.375 10.9062 15.5 10.7812 15.5 10.5938V9.90625C15.5 9.71875 15.375 9.59375 15.1875 9.59375Z"
                                                                      fill="currentColor" />
                                                                <path d="M6.5 12H5.8125C5.625 12 5.5 12.125 5.5 12.3125V13C5.5 13.1875 5.625 13.3125 5.8125 13.3125H6.5C6.6875 13.3125 6.8125 13.1875 6.8125 13V12.3125C6.8125 12.125 6.65625 12 6.5 12Z"
                                                                      fill="currentColor" />
                                                                <path d="M9.5 12H8.8125C8.625 12 8.5 12.125 8.5 12.3125V13C8.5 13.1875 8.625 13.3125 8.8125 13.3125H9.5C9.6875 13.3125 9.8125 13.1875 9.8125 13V12.3125C9.8125 12.125 9.65625 12 9.5 12Z"
                                                                      fill="currentColor" />
                                                                <path d="M12.3438 12H11.6562C11.4687 12 11.3438 12.125 11.3438 12.3125V13C11.3438 13.1875 11.4687 13.3125 11.6562 13.3125H12.3438C12.5312 13.3125 12.6562 13.1875 12.6562 13V12.3125C12.6562 12.125 12.5312 12 12.3438 12Z"
                                                                      fill="currentColor" />
                                                                <path d="M15.1875 12H14.5C14.3125 12 14.1875 12.125 14.1875 12.3125V13C14.1875 13.1875 14.3125 13.3125 14.5 13.3125H15.1875C15.375 13.3125 15.5 13.1875 15.5 13V12.3125C15.5 12.125 15.375 12 15.1875 12Z"
                                                                      fill="currentColor" />
                                                                <path d="M6.5 14.4062H5.8125C5.625 14.4062 5.5 14.5312 5.5 14.7187V15.4062C5.5 15.5938 5.625 15.7188 5.8125 15.7188H6.5C6.6875 15.7188 6.8125 15.5938 6.8125 15.4062V14.7187C6.8125 14.5312 6.65625 14.4062 6.5 14.4062Z"
                                                                      fill="currentColor" />...
                                                                <path d="M9.5 14.4062H8.8125C8.625 14.4062 8.5 14.5312 8.5 14.7187V15.4062C8.5 15.5938 8.625 15.7188 8.8125 15.7188H9.5C9.6875 15.7188 9.8125 15.5938 9.8125 15.4062V14.7187C9.8125 14.5312 9.65625 14.4062 9.5 14.4062Z"
                                                                      fill="currentColor" />
                                                                <path d="M12.3438 14.4062H11.6562C11.4687 14.4062 11.3438 14.5312 11.3438 14.7187V15.4062C11.3438 15.5938 11.4687 15.7188 11.6562 15.7188H12.3438C12.5312 15.7188 12.6562 15.5938 12.6562 15.4062V14.7187C12.6562 14.5312 12.5312 14.4062 12.3438 14.4062Z"
                                                                      fill="currentColor" />
                                                            </svg>
                                                        </span>
                                                    </div>
                                                    <div id="datepicker-container_@i"
                                                         class="w-full flex-col rounded-xl bg-white p-4 shadow-lg sm:p-[30px] dark:bg-dark-2 dark:shadow-box-dark hidden">
                                                        <div class="flex items-center justify-between pb-4">
                                                            <div id="prevMonth_@i"
                                                                 class="flex h-[38px] w-[38px] cursor-pointer items-center justify-center rounded-[7px] border-[.5px] border-stroke bg-gray-2 text-dark hover:border-[#38679D] hover:bg-[#38679D] hover:text-white sm:h-[46px] sm:w-[46px] dark:border-dark-3 dark:bg-dark dark:text-white">
                                                                <svg width="24"
                                                                     height="24"
                                                                     viewBox="0 0 24 24"
                                                                     fill="none"
                                                                     xmlns="http://www.w3.org/2000/svg"
                                                                     class="fill-current">
                                                                    <path d="M16.2375 21.4875C16.0125 21.4875 15.7875 21.4125 15.6375 21.225L7.16249 12.6C6.82499 12.2625 6.82499 11.7375 7.16249 11.4L15.6375 2.77498C15.975 2.43748 16.5 2.43748 16.8375 2.77498C17.175 3.11248 17.175 3.63748 16.8375 3.97498L8.96249 12L16.875 20.025C17.2125 20.3625 17.2125 20.8875 16.875 21.225C16.65 21.375 16.4625 21.4875 16.2375 21.4875Z" />
                                                                </svg>
                                                            </div>
                                                            <span id="currentMonth_@i"
                                                                  class="text-xl font-medium capitalize text-dark dark:text-white">
                                                            </span>
                                                            <div id="nextMonth_@i"
                                                                 class="flex h-[38px] w-[38px] cursor-pointer items-center justify-center rounded-[7px] border-[.5px] border-stroke bg-gray-2 text-dark hover:border-[#38679D] hover:bg-[#38679D] hover:text-white sm:h-[46px] sm:w-[46px] dark:border-dark-3 dark:bg-dark dark:text-white">
                                                                <svg width="24"
                                                                     height="24"
                                                                     viewBox="0 0 24 24"
                                                                     fill="none"
                                                                     xmlns="http://www.w3.org/2000/svg"
                                                                     class="fill-current">
                                                                    <path d="M7.7625 21.4875C7.5375 21.4875 7.35 21.4125 7.1625 21.2625C6.825 20.925 6.825 20.4 7.1625 20.0625L15.0375 12L7.1625 3.97498C6.825 3.63748 6.825 3.11248 7.1625 2.77498C7.5 2.43748 8.025 2.43748 8.3625 2.77498L16.8375 11.4C17.175 11.7375 17.175 12.2625 16.8375 12.6L8.3625 21.225C8.2125 21.375 7.9875 21.4875 7.7625 21.4875Z" />
                                                                </svg>
                                                            </div>
                                                        </div>
                                                        <div class="grid grid-cols-7 justify-between pb-2 pt-4 text-sm font-medium capitalize text-body-color sm:text-lg dark:text-dark-6">
                                                            <span class="flex h-[38px] w-[38px] items-center justify-center sm:h-[46px] sm:w-[47px]">
                                                                Do
                                                            </span>

                                                            <span class="flex h-[38px] w-[38px] items-center justify-center sm:h-[46px] sm:w-[47px]">
                                                                Lu
                                                            </span>

                                                            <span class="flex h-[38px] w-[38px] items-center justify-center sm:h-[46px] sm:w-[47px]">
                                                                Ma
                                                            </span>

                                                            <span class="flex h-[38px] w-[38px] items-center justify-center sm:h-[46px] sm:w-[47px]">
                                                                Me
                                                            </span>

                                                            <span class="flex h-[38px] w-[38px] items-center justify-center sm:h-[46px] sm:w-[47px]">
                                                                Gi
                                                            </span>

                                                            <span class="flex h-[38px] w-[38px] items-center justify-center sm:h-[46px] sm:w-[47px]">
                                                                Ve
                                                            </span>

                                                            <span class="flex h-[38px] w-[38px] items-center justify-center sm:h-[46px] sm:w-[47px]">
                                                                Sa
                                                            </span>
                                                        </div>

                                                        <div id="days-container_@i"
                                                             class="grid grid-cols-7 justify-between text-sm font-medium sm:text-lg"></div>

                                                        <div class="flex items-center space-x-3 pt-4 sm:space-x-5">
                                                            <button id="cancelButton_@i"
                                                                    class="flex h-[50px] w-full items-center justify-center rounded-md bg-gray-300 text-base font-medium text-dark hover:bg-opacity-90 cursor-pointer">
                                                                Cancella
                                                            </button>
                                                            <button id="applyButton_@i"
                                                                    class="flex h-[50px] w-full items-center justify-center rounded-md bg-[#38679D] text-base font-medium text-white hover:bg-blue-dark cursor-pointer">
                                                                Ok
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </section>
                                        <!-- ====== Date Picker End -->

                                        <script>
                                            document.addEventListener('DOMContentLoaded', function() {
                                                (function() {
                                                    const i = @i;
                                                    const datepicker = document.getElementById('datepicker_' + i);
                                                    const datepickerContainer = document.getElementById('datepicker-container_' + i);
                                                    const daysContainer = document.getElementById('days-container_' + i);
                                                    const currentMonthElement = document.getElementById('currentMonth_' + i);
                                                    const prevMonthButton = document.getElementById('prevMonth_' + i);
                                                    const nextMonthButton = document.getElementById('nextMonth_' + i);
                                                    const cancelButton = document.getElementById('cancelButton_' + i);
                                                    const applyButton = document.getElementById('applyButton_' + i);
                                                    const toggleDatepicker = document.getElementById('toggleDatepicker_' + i);

                                                    let currentDate = new Date();
                                                    let selectedDate = null;

                                                    function renderCalendar() {
                                                        const year = currentDate.getFullYear();
                                                        const month = currentDate.getMonth();

                                                        currentMonthElement.textContent = currentDate.toLocaleDateString('it-IT', { month: 'long', year: 'numeric' });

                                                        daysContainer.innerHTML = '';
                                                        const firstDayOfMonth = new Date(year, month, 1).getDay();
                                                        const daysInMonth = new Date(year, month + 1, 0).getDate();

                                                        for (let i = 0; i < firstDayOfMonth; i++) {
                                                            daysContainer.innerHTML += `<div></div>`;
                                                        }
                                                        for (let i = 1; i <= daysInMonth; i++) {
                                                            daysContainer.innerHTML += `<div class="flex h-[38px] w-[38px] items-center justify-center rounded-[7px] border-[.5px] border-transparent text-dark hover:border-stroke hover:bg-gray-2 sm:h-[46px] sm:w-[47px] dark:text-white dark:hover:border-dark-3 dark:hover:bg-dark mb-2">${i}</div>`;
                                                        }

                                                        document.querySelectorAll(`#days-container_${i} div`).forEach(day => {
                                                            day.addEventListener('click', function() {
                                                                const day = this.textContent.padStart(2, '0');
                                                                const formattedMonth = (currentDate.getMonth() + 1).toString().padStart(2, '0');
                                                                selectedDate = `${day}-${formattedMonth}-${year}`;

                                                                document.querySelectorAll(`#days-container_${i} div`).forEach(d => d.classList.remove('bg-[#38679D]', 'text-white', 'dark:text-white'));
                                                                this.classList.add('bg-[#38679D]', 'text-white', 'dark:text-white');
                                                            });
                                                        });
                                                    }

                                                    datepicker.addEventListener('click', function() {
                                                        datepickerContainer.classList.toggle('hidden');
                                                        renderCalendar();
                                                    });

                                                    toggleDatepicker.addEventListener('click', function() {
                                                        datepickerContainer.classList.toggle('hidden');
                                                        renderCalendar();
                                                    });

                                                    prevMonthButton.addEventListener('click', function() {
                                                        currentDate.setMonth(currentDate.getMonth() - 1);
                                                        renderCalendar();
                                                    });

                                                    nextMonthButton.addEventListener('click', function() {
                                                        currentDate.setMonth(currentDate.getMonth() + 1);
                                                        renderCalendar();
                                                    });

                                                    cancelButton.addEventListener('click', function() {
                                                        selectedDate = null;
                                                        datepickerContainer.classList.add('hidden');
                                                    });

                                                    applyButton.addEventListener('click', function() {
                                                        if (selectedDate) {
                                                            datepicker.value = selectedDate;
                                                        }
                                                        datepickerContainer.classList.add('hidden');
                                                    });

                                                    document.addEventListener('click', function(event) {
                                                        if (!datepicker.contains(event.target) && !datepickerContainer.contains(event.target)) {
                                                            datepickerContainer.classList.add('hidden');
                                                        }
                                                    });
                                                })();
                                            });
                                        </script>
                                    }
                                </div>
                            }
                            else
                            {
                                <form class="w-full mb-5 mt-12">
                                    <fieldset class="space-y-6">
                                        <div class="py-4 border-b border-gray-300">
                                            <legend class="text-2xl text-gray-700 mr-4">Giorno della settimana</legend>
                                        </div>
                                        <div class="grid grid-cols-1 lg:grid-cols-7 gap-5">
                                            <label for="lunedì" class="relative flex flex-col bg-white p-5 rounded-lg shadow-md cursor-pointer">
                                                <span>
                                                    Lunedì
                                                </span>
                                                <input type="radio" name="giorno" id="lunedì" value="lunedì" class="color absolute h-0 w-0 appearance-none weekday" />
                                                <span aria-hidden="true" class="hidden absolute inset-0 border-2 border-[#38679D] rounded-lg">
                                                    <span class="absolute top-1/2 -translate-y-1/2 right-4 h-6 w-6 inline-flex items-center justify-center rounded-full bg-[#38679D]/90">
                                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-5 w-5 text-white">
                                                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                                                        </svg>
                                                    </span>
                                                </span>
                                            </label>
                                            <label for="martedì" class="relative flex flex-col bg-white p-5 rounded-lg shadow-md cursor-pointer">
                                                <span>
                                                    Martedì
                                                </span>
                                                <input type="radio" name="giorno" id="martedì" value="martedì" class="color absolute h-0 w-0 appearance-none weekday" />
                                                <span aria-hidden="true" class="hidden absolute inset-0 border-2 border-[#38679D] rounded-lg">
                                                    <span class="absolute top-1/2 -translate-y-1/2 right-4 h-6 w-6 inline-flex items-center justify-center rounded-full bg-[#38679D]/90">
                                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-5 w-5 text-white">
                                                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                                                        </svg>
                                                    </span>
                                                </span>
                                            </label>
                                            <label for="mercoledì" class="relative flex flex-col bg-white p-5 rounded-lg shadow-md cursor-pointer">
                                                <span>
                                                    Mercoledì
                                                </span>
                                                <input type="radio" name="giorno" id="mercoledì" value="mercoledì" class="color absolute h-0 w-0 appearance-none weekday" />
                                                <span aria-hidden="true" class="hidden absolute inset-0 border-2 border-[#38679D] rounded-lg">
                                                    <span class="absolute top-1/2 -translate-y-1/2 right-4 h-6 w-6 inline-flex items-center justify-center rounded-full bg-[#38679D]/90">
                                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-5 w-5 text-white">
                                                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                                                        </svg>
                                                    </span>
                                                </span>
                                            </label>
                                            <label for="giovedì" class="relative flex flex-col bg-white p-5 rounded-lg shadow-md cursor-pointer">
                                                <span>
                                                    Giovedì
                                                </span>
                                                <input type="radio" name="giorno" id="giovedì" value="giovedì" class="color absolute h-0 w-0 appearance-none weekday" />
                                                <span aria-hidden="true" class="hidden absolute inset-0 border-2 border-[#38679D] rounded-lg">
                                                    <span class="absolute top-1/2 -translate-y-1/2 right-4 h-6 w-6 inline-flex items-center justify-center rounded-full bg-[#38679D]/90">
                                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-5 w-5 text-white">
                                                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                                                        </svg>
                                                    </span>
                                                </span>
                                            </label>
                                            <label for="venerdì" class="relative flex flex-col bg-white p-5 rounded-lg shadow-md cursor-pointer">
                                                <span>
                                                    Venerdì
                                                </span>
                                                <input type="radio" name="giorno" id="venerdì" value="venerdì" class="color absolute h-0 w-0 appearance-none weekday" />
                                                <span aria-hidden="true" class="hidden absolute inset-0 border-2 border-[#38679D] rounded-lg">
                                                    <span class="absolute top-1/2 -translate-y-1/2 right-4 h-6 w-6 inline-flex items-center justify-center rounded-full bg-[#38679D]/90">
                                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-5 w-5 text-white">
                                                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                                                        </svg>
                                                    </span>
                                                </span>
                                            </label>
                                            <label for="sabato" class="relative flex flex-col bg-white p-5 rounded-lg shadow-md cursor-pointer">
                                                <span>
                                                    Sabato
                                                </span>
                                                <input type="radio" name="giorno" id="sabato" value="sabato" class="color absolute h-0 w-0 appearance-none weekday" />
                                                <span aria-hidden="true" class="hidden absolute inset-0 border-2 border-[#38679D] rounded-lg">
                                                    <span class="absolute top-1/2 -translate-y-1/2 right-4 h-6 w-6 inline-flex items-center justify-center rounded-full bg-[#38679D]/90">
                                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-5 w-5 text-white">
                                                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                                                        </svg>
                                                    </span>
                                                </span>
                                            </label>
                                            <label for="domenica" class="relative flex flex-col bg-white p-5 rounded-lg shadow-md cursor-pointer">
                                                <span>
                                                    Domenica
                                                </span>
                                                <input type="radio" name="giorno" id="domenica" value="domenica" class="color absolute h-0 w-0 appearance-none weekday" />
                                                <span aria-hidden="true" class="hidden absolute inset-0 border-2 border-[#38679D] rounded-lg">
                                                    <span class="absolute top-1/2 -translate-y-1/2 right-4 h-6 w-6 inline-flex items-center justify-center rounded-full bg-[#38679D]/90">
                                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-5 w-5 text-white">
                                                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                                                        </svg>
                                                    </span>
                                                </span>
                                            </label>
                                        </div>
                                    </fieldset>
                                </form>
                            }
                        </div>      
                    }                            
                }
            </div>
        </div>
    }
    <div class="container mx-auto mt-24">
        <div class="relative p-4 lg:p-8 bg-white rounded-lg shadow-lg dark:bg-dark-2">
            <form id="dataForm">
                <h2 class="text-xl font-semibold">Inserisci i dati per la consegna</h2>
                @if(Model.Prezzo > 27 || Model.Prezzo == null)
                {
                    <div class="my-7 relative">
                        <label class="block mb-3">Indirizzo</label>
                        <textarea id="cemeterySearch"
                                  required
                                  rows="3"
                                  placeholder="Cerca cimitero/indirizzo (es: Cimitero Monumentale Milano) o inseriscilo manualmente"
                                  class="border-stroke dark:border-dark-3 dark:text-dark-6 dark:bg-dark text-body-color focus:border-primary w-full rounded border py-3 px-[14px] text-base outline-none focus:border-blue-500 lg:h-12 lg:max-h-12 lg:overflow-y-auto">@(datiEsterni.IndirizzoConsegna ?? "")</textarea>
                        <div id="searchResults" class="absolute z-50 w-full bg-white border border-gray-300 rounded-b shadow-lg mt-1 max-h-60 overflow-auto"></div>
                    </div>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-7 mb-7">
                        <div>
                            <label class="block mb-3">Nome defunto</label>
                            <input type="text"
                                   placeholder="Nome"
                                   required
                                   value="@(datiEsterni.NomeDefunto ?? "")"
                                   id="nomeDestinatario"
                                   class="border-stroke dark:border-dark-3 dark:text-dark-6 dark:bg-dark text-body-color focus:border-primary w-full rounded border py-3 px-[14px] text-base outline-none focus:border-blue-500" />
                        </div>
                        <div>
                            <label class="block mb-3">Cognome defunto</label>
                            <input type="text"
                                   placeholder="Cognome"
                                   required
                                   value="@(datiEsterni.CognomeDefunto ?? "")"
                                   id="cognomeDestinatario"
                                   class="border-stroke dark:border-dark-3 dark:text-dark-6 dark:bg-dark text-body-color focus:border-primary w-full rounded border py-3 px-[14px] text-base outline-none focus:border-blue-500" />
                        </div>
                    </div>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-7 mb-7">
                        <div>
                            <label class="block mb-3">Data di nascita (opzionale)</label>
                            <input type="date"
                                   id="dataNascita"
                                   value="@(datiEsterni.DataNascita != null ? ((DateTime)datiEsterni.DataNascita).ToString("yyyy-MM-dd") : "")"
                                   class="border-stroke dark:border-dark-3 dark:text-dark-6 dark:bg-dark text-body-color focus:border-primary w-full rounded border py-3 px-[14px] text-base outline-none focus:border-blue-500" />
                        </div>
                        <div>
                            <label class="block mb-3">Data di morte (opzionale)</label>
                            <input type="date"
                                   id="dataMorte"
                                   value="@(datiEsterni.DataMorte != null ? ((DateTime)datiEsterni.DataMorte).ToString("yyyy-MM-dd") : "")"
                                   class="border-stroke dark:border-dark-3 dark:text-dark-6 dark:bg-dark text-body-color focus:border-primary w-full rounded border py-3 px-[14px] text-base outline-none focus:border-blue-500" />
                        </div>
                    </div>
                    <div class="lg:col-span-2 mb-7">
                        <label class="block mb-3">Informazioni (opzionale)</label>
                        <textarea id="infoArea" rows="3" placeholder="Info particolari sulla consegna o altro" class="border-stroke dark:border-dark-3 dark:text-dark-6 dark:bg-dark text-body-color focus:border-primary w-full rounded border py-3 px-[14px] text-base outline-none focus:border-blue-500">@(datiEsterni.Info ?? "")</textarea>
                    </div>
                }
                else
                {
                    <div class="my-7">
                        <label class="block mb-3">Scegli a quale prodotto abbinarlo</label>
                        <select type="text"
                               id="selectProduct"
                               required
                               placeholder="Cerca cimitero/indirizzo (es: Cimitero Monumentale Milano) o inseriscilo manualmente"
                               class="border-stroke dark:border-dark-3 dark:text-dark-6 dark:bg-dark text-body-color focus:border-primary w-full rounded border py-3 px-[14px] text-base outline-none focus:border-blue-500 text-center">
                                @foreach(var prod in prodottiCarrello)
                                {
                                    if (prod.AbbonamentoId.HasValue)
                                    {
                                        <option value="@prod.AbbonamentoId">@prod.NomeDettaglioProdotto</option>
                                    }
                                    else
                                    {
                                        <option value="@prod.ProdottoId">@prod.NomeProdotto</option>
                                    }
                                }
                        </select>
                    </div>
                }
                <div class="lg:col-span-2">
                    <button type="submit" id="submitBtn"
                            class="w-full p-3 text-white transition border rounded border-[#38679D] bg-[#38679D] hover:bg-opacity-90 cursor-pointer">
                        Invia
                    </button>
                </div>
            </form>
            <div>
                <span class="absolute -top-10 -right-9 z-[-1]">
                    <svg width="100"
                         height="100"
                         viewBox="0 0 100 100"
                         fill="none"
                         xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd"
                              clip-rule="evenodd"
                              d="M0 100C0 44.7715 0 0 0 0C55.2285 0 100 44.7715 100 100C100 100 100 100 0 100Z"
                              fill="#38679D" />
                    </svg>
                </span>
                <span class="absolute -right-10 top-[90px] z-[-1]">
                    <svg width="34"
                         height="134"
                         viewBox="0 0 34 134"
                         fill="none"
                         xmlns="http://www.w3.org/2000/svg">
                        <circle cx="31.9993"
                                cy="132"
                                r="1.66667"
                                transform="rotate(180 31.9993 132)"
                                fill="#38679D" />
                        <circle cx="31.9993"
                                cy="117.333"
                                r="1.66667"
                                transform="rotate(180 31.9993 117.333)"
                                fill="#38679D" />
                        <circle cx="31.9993"
                                cy="102.667"
                                r="1.66667"
                                transform="rotate(180 31.9993 102.667)"
                                fill="#38679D" />
                        <circle cx="31.9993"
                                cy="88"
                                r="1.66667"
                                transform="rotate(180 31.9993 88)"
                                fill="#38679D" />
                        <circle cx="31.9993"
                                cy="73.3333"
                                r="1.66667"
                                transform="rotate(180 31.9993 73.3333)"
                                fill="#38679D" />
                        <circle cx="31.9993"
                                cy="45"
                                r="1.66667"
                                transform="rotate(180 31.9993 45)"
                                fill="#38679D" />
                        <circle cx="31.9993"
                                cy="16"
                                r="1.66667"
                                transform="rotate(180 31.9993 16)"
                                fill="#38679D" />
                        <circle cx="31.9993"
                                cy="59"
                                r="1.66667"
                                transform="rotate(180 31.9993 59)"
                                fill="#38679D" />
                        <circle cx="31.9993"
                                cy="30.6666"
                                r="1.66667"
                                transform="rotate(180 31.9993 30.6666)"
                                fill="#38679D" />
                        <circle cx="31.9993"
                                cy="1.66665"
                                r="1.66667"
                                transform="rotate(180 31.9993 1.66665)"
                                fill="#38679D" />
                        <circle cx="17.3333"
                                cy="132"
                                r="1.66667"
                                transform="rotate(180 17.3333 132)"
                                fill="#38679D" />
                        <circle cx="17.3333"
                                cy="117.333"
                                r="1.66667"
                                transform="rotate(180 17.3333 117.333)"
                                fill="#38679D" />
                        <circle cx="17.3333"
                                cy="102.667"
                                r="1.66667"
                                transform="rotate(180 17.3333 102.667)"
                                fill="#38679D" />
                        <circle cx="17.3333"
                                cy="88"
                                r="1.66667"
                                transform="rotate(180 17.3333 88)"
                                fill="#38679D" />
                        <circle cx="17.3333"
                                cy="73.3333"
                                r="1.66667"
                                transform="rotate(180 17.3333 73.3333)"
                                fill="#38679D" />
                        <circle cx="17.3333"
                                cy="45"
                                r="1.66667"
                                transform="rotate(180 17.3333 45)"
                                fill="#38679D" />
                        <circle cx="17.3333"
                                cy="16"
                                r="1.66667"
                                transform="rotate(180 17.3333 16)"
                                fill="#38679D" />
                        <circle cx="17.3333"
                                cy="59"
                                r="1.66667"
                                transform="rotate(180 17.3333 59)"
                                fill="#38679D" />
                        <circle cx="17.3333"
                                cy="30.6666"
                                r="1.66667"
                                transform="rotate(180 17.3333 30.6666)"
                                fill="#38679D" />
                        <circle cx="17.3333"
                                cy="1.66665"
                                r="1.66667"
                                transform="rotate(180 17.3333 1.66665)"
                                fill="#38679D" />
                        <circle cx="2.66536"
                                cy="132"
                                r="1.66667"
                                transform="rotate(180 2.66536 132)"
                                fill="#38679D" />
                        <circle cx="2.66536"
                                cy="117.333"
                                r="1.66667"
                                transform="rotate(180 2.66536 117.333)"
                                fill="#38679D" />
                        <circle cx="2.66536"
                                cy="102.667"
                                r="1.66667"
                                transform="rotate(180 2.66536 102.667)"
                                fill="#38679D" />
                        <circle cx="2.66536"
                                cy="88"
                                r="1.66667"
                                transform="rotate(180 2.66536 88)"
                                fill="#38679D" />
                        <circle cx="2.66536"
                                cy="73.3333"
                                r="1.66667"
                                transform="rotate(180 2.66536 73.3333)"
                                fill="#38679D" />
                        <circle cx="2.66536"
                                cy="45"
                                r="1.66667"
                                transform="rotate(180 2.66536 45)"
                                fill="#38679D" />
                        <circle cx="2.66536"
                                cy="16"
                                r="1.66667"
                                transform="rotate(180 2.66536 16)"
                                fill="#38679D" />
                        <circle cx="2.66536"
                                cy="59"
                                r="1.66667"
                                transform="rotate(180 2.66536 59)"
                                fill="#38679D" />
                        <circle cx="2.66536"
                                cy="30.6666"
                                r="1.66667"
                                transform="rotate(180 2.66536 30.6666)"
                                fill="#38679D" />
                        <circle cx="2.66536"
                                cy="1.66665"
                                r="1.66667"
                                transform="rotate(180 2.66536 1.66665)"
                                fill="#38679D" />
                    </svg>
                </span>
                <span class="absolute -left-7 -bottom-7 z-[-1]">
                    <svg width="107"
                         height="134"
                         viewBox="0 0 107 134"
                         fill="none"
                         xmlns="http://www.w3.org/2000/svg">
                        <circle cx="104.999"
                                cy="132"
                                r="1.66667"
                                transform="rotate(180 104.999 132)"
                                fill="#38679D" />
                        <circle cx="104.999"
                                cy="117.333"
                                r="1.66667"
                                transform="rotate(180 104.999 117.333)"
                                fill="#38679D" />
                        <circle cx="104.999"
                                cy="102.667"
                                r="1.66667"
                                transform="rotate(180 104.999 102.667)"
                                fill="#38679D" />
                        <circle cx="104.999"
                                cy="88"
                                r="1.66667"
                                transform="rotate(180 104.999 88)"
                                fill="#38679D" />
                        <circle cx="104.999"
                                cy="73.3333"
                                r="1.66667"
                                transform="rotate(180 104.999 73.3333)"
                                fill="#38679D" />
                        <circle cx="104.999"
                                cy="45"
                                r="1.66667"
                                transform="rotate(180 104.999 45)"
                                fill="#38679D" />
                        <circle cx="104.999"
                                cy="16"
                                r="1.66667"
                                transform="rotate(180 104.999 16)"
                                fill="#38679D" />
                        <circle cx="104.999"
                                cy="59"
                                r="1.66667"
                                transform="rotate(180 104.999 59)"
                                fill="#38679D" />
                        <circle cx="104.999"
                                cy="30.6666"
                                r="1.66667"
                                transform="rotate(180 104.999 30.6666)"
                                fill="#38679D" />
                        <circle cx="104.999"
                                cy="1.66665"
                                r="1.66667"
                                transform="rotate(180 104.999 1.66665)"
                                fill="#38679D" />
                        <circle cx="90.3333"
                                cy="132"
                                r="1.66667"
                                transform="rotate(180 90.3333 132)"
                                fill="#38679D" />
                        <circle cx="90.3333"
                                cy="117.333"
                                r="1.66667"
                                transform="rotate(180 90.3333 117.333)"
                                fill="#38679D" />
                        <circle cx="90.3333"
                                cy="102.667"
                                r="1.66667"
                                transform="rotate(180 90.3333 102.667)"
                                fill="#38679D" />
                        <circle cx="90.3333"
                                cy="88"
                                r="1.66667"
                                transform="rotate(180 90.3333 88)"
                                fill="#38679D" />
                        <circle cx="90.3333"
                                cy="73.3333"
                                r="1.66667"
                                transform="rotate(180 90.3333 73.3333)"
                                fill="#38679D" />
                        <circle cx="90.3333"
                                cy="45"
                                r="1.66667"
                                transform="rotate(180 90.3333 45)"
                                fill="#38679D" />
                        <circle cx="90.3333"
                                cy="16"
                                r="1.66667"
                                transform="rotate(180 90.3333 16)"
                                fill="#38679D" />
                        <circle cx="90.3333"
                                cy="59"
                                r="1.66667"
                                transform="rotate(180 90.3333 59)"
                                fill="#38679D" />
                        <circle cx="90.3333"
                                cy="30.6666"
                                r="1.66667"
                                transform="rotate(180 90.3333 30.6666)"
                                fill="#38679D" />
                        <circle cx="90.3333"
                                cy="1.66665"
                                r="1.66667"
                                transform="rotate(180 90.3333 1.66665)"
                                fill="#38679D" />
                        <circle cx="75.6654"
                                cy="132"
                                r="1.66667"
                                transform="rotate(180 75.6654 132)"
                                fill="#38679D" />
                        <circle cx="31.9993"
                                cy="132"
                                r="1.66667"
                                transform="rotate(180 31.9993 132)"
                                fill="#38679D" />
                        <circle cx="75.6654"
                                cy="117.333"
                                r="1.66667"
                                transform="rotate(180 75.6654 117.333)"
                                fill="#38679D" />
                        <circle cx="31.9993"
                                cy="117.333"
                                r="1.66667"
                                transform="rotate(180 31.9993 117.333)"
                                fill="#38679D" />
                        <circle cx="75.6654"
                                cy="102.667"
                                r="1.66667"
                                transform="rotate(180 75.6654 102.667)"
                                fill="#38679D" />
                        <circle cx="31.9993"
                                cy="102.667"
                                r="1.66667"
                                transform="rotate(180 31.9993 102.667)"
                                fill="#38679D" />
                        <circle cx="75.6654"
                                cy="88"
                                r="1.66667"
                                transform="rotate(180 75.6654 88)"
                                fill="#38679D" />
                        <circle cx="31.9993"
                                cy="88"
                                r="1.66667"
                                transform="rotate(180 31.9993 88)"
                                fill="#38679D" />
                        <circle cx="75.6654"
                                cy="73.3333"
                                r="1.66667"
                                transform="rotate(180 75.6654 73.3333)"
                                fill="#38679D" />
                        <circle cx="31.9993"
                                cy="73.3333"
                                r="1.66667"
                                transform="rotate(180 31.9993 73.3333)"
                                fill="#38679D" />
                        <circle cx="75.6654"
                                cy="45"
                                r="1.66667"
                                transform="rotate(180 75.6654 45)"
                                fill="#38679D" />
                        <circle cx="31.9993"
                                cy="45"
                                r="1.66667"
                                transform="rotate(180 31.9993 45)"
                                fill="#38679D" />
                        <circle cx="75.6654"
                                cy="16"
                                r="1.66667"
                                transform="rotate(180 75.6654 16)"
                                fill="#38679D" />
                        <circle cx="31.9993"
                                cy="16"
                                r="1.66667"
                                transform="rotate(180 31.9993 16)"
                                fill="#38679D" />
                        <circle cx="75.6654"
                                cy="59"
                                r="1.66667"
                                transform="rotate(180 75.6654 59)"
                                fill="#38679D" />
                        <circle cx="31.9993"
                                cy="59"
                                r="1.66667"
                                transform="rotate(180 31.9993 59)"
                                fill="#38679D" />
                        <circle cx="75.6654"
                                cy="30.6666"
                                r="1.66667"
                                transform="rotate(180 75.6654 30.6666)"
                                fill="#38679D" />
                        <circle cx="31.9993"
                                cy="30.6666"
                                r="1.66667"
                                transform="rotate(180 31.9993 30.6666)"
                                fill="#38679D" />
                        <circle cx="75.6654"
                                cy="1.66665"
                                r="1.66667"
                                transform="rotate(180 75.6654 1.66665)"
                                fill="#38679D" />
                        <circle cx="31.9993"
                                cy="1.66665"
                                r="1.66667"
                                transform="rotate(180 31.9993 1.66665)"
                                fill="#38679D" />
                        <circle cx="60.9993"
                                cy="132"
                                r="1.66667"
                                transform="rotate(180 60.9993 132)"
                                fill="#38679D" />
                        <circle cx="17.3333"
                                cy="132"
                                r="1.66667"
                                transform="rotate(180 17.3333 132)"
                                fill="#38679D" />
                        <circle cx="60.9993"
                                cy="117.333"
                                r="1.66667"
                                transform="rotate(180 60.9993 117.333)"
                                fill="#38679D" />
                        <circle cx="17.3333"
                                cy="117.333"
                                r="1.66667"
                                transform="rotate(180 17.3333 117.333)"
                                fill="#38679D" />
                        <circle cx="60.9993"
                                cy="102.667"
                                r="1.66667"
                                transform="rotate(180 60.9993 102.667)"
                                fill="#38679D" />
                        <circle cx="17.3333"
                                cy="102.667"
                                r="1.66667"
                                transform="rotate(180 17.3333 102.667)"
                                fill="#38679D" />
                        <circle cx="60.9993"
                                cy="88"
                                r="1.66667"
                                transform="rotate(180 60.9993 88)"
                                fill="#38679D" />
                        <circle cx="17.3333"
                                cy="88"
                                r="1.66667"
                                transform="rotate(180 17.3333 88)"
                                fill="#38679D" />
                        <circle cx="60.9993"
                                cy="73.3333"
                                r="1.66667"
                                transform="rotate(180 60.9993 73.3333)"
                                fill="#38679D" />
                        <circle cx="17.3333"
                                cy="73.3333"
                                r="1.66667"
                                transform="rotate(180 17.3333 73.3333)"
                                fill="#38679D" />
                        <circle cx="60.9993"
                                cy="45"
                                r="1.66667"
                                transform="rotate(180 60.9993 45)"
                                fill="#38679D" />
                        <circle cx="17.3333"
                                cy="45"
                                r="1.66667"
                                transform="rotate(180 17.3333 45)"
                                fill="#38679D" />
                        <circle cx="60.9993"
                                cy="16"
                                r="1.66667"
                                transform="rotate(180 60.9993 16)"
                                fill="#38679D" />
                        <circle cx="17.3333"
                                cy="16"
                                r="1.66667"
                                transform="rotate(180 17.3333 16)"
                                fill="#38679D" />
                        <circle cx="60.9993"
                                cy="59"
                                r="1.66667"
                                transform="rotate(180 60.9993 59)"
                                fill="#38679D" />
                        <circle cx="17.3333"
                                cy="59"
                                r="1.66667"
                                transform="rotate(180 17.3333 59)"
                                fill="#38679D" />
                        <circle cx="60.9993"
                                cy="30.6666"
                                r="1.66667"
                                transform="rotate(180 60.9993 30.6666)"
                                fill="#38679D" />
                        <circle cx="17.3333"
                                cy="30.6666"
                                r="1.66667"
                                transform="rotate(180 17.3333 30.6666)"
                                fill="#38679D" />
                        <circle cx="60.9993"
                                cy="1.66665"
                                r="1.66667"
                                transform="rotate(180 60.9993 1.66665)"
                                fill="#38679D" />
                        <circle cx="17.3333"
                                cy="1.66665"
                                r="1.66667"
                                transform="rotate(180 17.3333 1.66665)"
                                fill="#38679D" />
                        <circle cx="46.3333"
                                cy="132"
                                r="1.66667"
                                transform="rotate(180 46.3333 132)"
                                fill="#38679D" />
                        <circle cx="2.66536"
                                cy="132"
                                r="1.66667"
                                transform="rotate(180 2.66536 132)"
                                fill="#38679D" />
                        <circle cx="46.3333"
                                cy="117.333"
                                r="1.66667"
                                transform="rotate(180 46.3333 117.333)"
                                fill="#38679D" />
                        <circle cx="2.66536"
                                cy="117.333"
                                r="1.66667"
                                transform="rotate(180 2.66536 117.333)"
                                fill="#38679D" />
                        <circle cx="46.3333"
                                cy="102.667"
                                r="1.66667"
                                transform="rotate(180 46.3333 102.667)"
                                fill="#38679D" />
                        <circle cx="2.66536"
                                cy="102.667"
                                r="1.66667"
                                transform="rotate(180 2.66536 102.667)"
                                fill="#38679D" />
                        <circle cx="46.3333"
                                cy="88"
                                r="1.66667"
                                transform="rotate(180 46.3333 88)"
                                fill="#38679D" />
                        <circle cx="2.66536"
                                cy="88"
                                r="1.66667"
                                transform="rotate(180 2.66536 88)"
                                fill="#38679D" />
                        <circle cx="46.3333"
                                cy="73.3333"
                                r="1.66667"
                                transform="rotate(180 46.3333 73.3333)"
                                fill="#38679D" />
                        <circle cx="2.66536"
                                cy="73.3333"
                                r="1.66667"
                                transform="rotate(180 2.66536 73.3333)"
                                fill="#38679D" />
                        <circle cx="46.3333"
                                cy="45"
                                r="1.66667"
                                transform="rotate(180 46.3333 45)"
                                fill="#38679D" />
                        <circle cx="2.66536"
                                cy="45"
                                r="1.66667"
                                transform="rotate(180 2.66536 45)"
                                fill="#38679D" />
                        <circle cx="46.3333"
                                cy="16"
                                r="1.66667"
                                transform="rotate(180 46.3333 16)"
                                fill="#38679D" />
                        <circle cx="2.66536"
                                cy="16"
                                r="1.66667"
                                transform="rotate(180 2.66536 16)"
                                fill="#38679D" />
                        <circle cx="46.3333"
                                cy="59"
                                r="1.66667"
                                transform="rotate(180 46.3333 59)"
                                fill="#38679D" />
                        <circle cx="2.66536"
                                cy="59"
                                r="1.66667"
                                transform="rotate(180 2.66536 59)"
                                fill="#38679D" />
                        <circle cx="46.3333"
                                cy="30.6666"
                                r="1.66667"
                                transform="rotate(180 46.3333 30.6666)"
                                fill="#38679D" />
                        <circle cx="2.66536"
                                cy="30.6666"
                                r="1.66667"
                                transform="rotate(180 2.66536 30.6666)"
                                fill="#38679D" />
                        <circle cx="46.3333"
                                cy="1.66665"
                                r="1.66667"
                                transform="rotate(180 46.3333 1.66665)"
                                fill="#38679D" />
                        <circle cx="2.66536"
                                cy="1.66665"
                                r="1.66667"
                                transform="rotate(180 2.66536 1.66665)"
                                fill="#38679D" />
                    </svg>
                </span>
            </div>
        </div>
    </div>
</div>

@if(Model.Categoria == Categoria.Bouquet)
{
    <section class="relative z-10 overflow-hidden bg-white dark:bg-dark pt-20 pb-12 lg:pt-[120px] lg:pb-[90px] mx-7">
        <div class="container mx-auto">
            <div class="-mx-4 flex flex-wrap">
                <div class="w-full px-7">
                    <div class="mx-auto mb-[60px] max-w-[750px] text-center">
                        <h2 class="mb-3 text-3xl leading-[1.208] font-bold text-dark dark:text-white sm:text-4xl md:text-[40px]">
                            Prodotti correlati
                        </h2>
                        <p class="text-body-color dark:text-dark-6">
                            Non perdere l'opportunità di aggiungere uno di questi prodotti al tuo bouquet.
                        </p>
                    </div>
                </div>
            </div>
            @{ 
                <div class="-mx-4 px-4 grid grid-cols-1 lg:grid-cols-2 md:w-2/3 md:mx-auto gap-4 md:gap-12">
                @foreach (var item in relatedProd.OrderBy(x => x.Prezzo))
                {
                    <div class="w-full px-4">
                        <div class="relative z-10 mb-10 overflow-hidden rounded-[10px] border-2 border-stroke dark:border-dark-3 bg-white dark:bg-dark-2 py-10 px-8 shadow-pricing sm:p-12 lg:py-10 lg:px-6 xl:p-[50px]">
                            <span class="mb-3 block text-lg font-semibold text-primary">
                                @item.Nome
                            </span>
                            <h2 class="mb-5 text-[42px] font-bold text-dark dark:text-white">
                                <span>€ @item.Prezzo</span>
                            </h2>
                            <img src="@item.Immagine" alt="immagine" class="rounded w-full h-80" />

                            <div class="mb-9 flex flex-col gap-[14px]">
                                <a href="@Url.Action("Dettaglio", "Home", new { id = item.Id, externalKey = Request.QueryString["externalKey"] })" class="text-base text-[#38679D] dark:text-dark-6 mt-3 underline">
                                    Descrizione completa
                                </a>
                            </div>
                            <a href="@Url.Action("Dettaglio", "Home", new { id = item.Id, externalKey = Request.QueryString["externalKey"] })"
                               class="cart block w-full rounded-md border border-stroke dark:border-dark-3 bg-[#38679D] p-3 text-center text-base font-medium text-white transition hover:border-[#38679D]/90 hover:bg-[#38679D]/90 hover:text-white">
                                Aggiungi al carrello
                            </a>
                            <div>
                                <span class="absolute right-0 top-7 z-[-1]">
                                    <svg width="77"
                                         height="172"
                                         viewBox="0 0 77 172"
                                         fill="none"
                                         xmlns="http://www.w3.org/2000/svg">
                                        <circle cx="86" cy="86" r="86" fill="url(#paint0_linear)" />
                                        <defs>
                                            <linearGradient id="paint0_linear"
                                                            x1="86"
                                                            y1="0"
                                                            x2="86"
                                                            y2="172"
                                                            gradientUnits="userSpaceOnUse">
                                                <stop stop-color="#38679D" stop-opacity="0.09" />
                                                <stop offset="1"
                                                      stop-color="#C4C4C4"
                                                      stop-opacity="0" />
                                            </linearGradient>
                                        </defs>
                                    </svg>
                                </span>
                                <span class="absolute right-4 top-4 z-[-1]">
                                    <svg width="41"
                                         height="89"
                                         viewBox="0 0 41 89"
                                         fill="none"
                                         xmlns="http://www.w3.org/2000/svg">
                                        <circle cx="38.9138"
                                                cy="87.4849"
                                                r="1.42021"
                                                transform="rotate(180 38.9138 87.4849)"
                                                fill="#38679D" />
                                        <circle cx="38.9138"
                                                cy="74.9871"
                                                r="1.42021"
                                                transform="rotate(180 38.9138 74.9871)"
                                                fill="#38679D" />
                                        <circle cx="38.9138"
                                                cy="62.4892"
                                                r="1.42021"
                                                transform="rotate(180 38.9138 62.4892)"
                                                fill="#38679D" />
                                        <circle cx="38.9138"
                                                cy="38.3457"
                                                r="1.42021"
                                                transform="rotate(180 38.9138 38.3457)"
                                                fill="#38679D" />
                                        <circle cx="38.9138"
                                                cy="13.634"
                                                r="1.42021"
                                                transform="rotate(180 38.9138 13.634)"
                                                fill="#38679D" />
                                        <circle cx="38.9138"
                                                cy="50.2754"
                                                r="1.42021"
                                                transform="rotate(180 38.9138 50.2754)"
                                                fill="#38679D" />
                                        <circle cx="38.9138"
                                                cy="26.1319"
                                                r="1.42021"
                                                transform="rotate(180 38.9138 26.1319)"
                                                fill="#38679D" />
                                        <circle cx="38.9138"
                                                cy="1.42021"
                                                r="1.42021"
                                                transform="rotate(180 38.9138 1.42021)"
                                                fill="#38679D" />
                                        <circle cx="26.4157"
                                                cy="87.4849"
                                                r="1.42021"
                                                transform="rotate(180 26.4157 87.4849)"
                                                fill="#38679D" />
                                        <circle cx="26.4157"
                                                cy="74.9871"
                                                r="1.42021"
                                                transform="rotate(180 26.4157 74.9871)"
                                                fill="#38679D" />
                                        <circle cx="26.4157"
                                                cy="62.4892"
                                                r="1.42021"
                                                transform="rotate(180 26.4157 62.4892)"
                                                fill="#38679D" />
                                        <circle cx="26.4157"
                                                cy="38.3457"
                                                r="1.42021"
                                                transform="rotate(180 26.4157 38.3457)"
                                                fill="#38679D" />
                                        <circle cx="26.4157"
                                                cy="13.634"
                                                r="1.42021"
                                                transform="rotate(180 26.4157 13.634)"
                                                fill="#38679D" />
                                        <circle cx="26.4157"
                                                cy="50.2754"
                                                r="1.42021"
                                                transform="rotate(180 26.4157 50.2754)"
                                                fill="#38679D" />
                                        <circle cx="26.4157"
                                                cy="26.1319"
                                                r="1.42021"
                                                transform="rotate(180 26.4157 26.1319)"
                                                fill="#38679D" />
                                        <circle cx="26.4157"
                                                cy="1.4202"
                                                r="1.42021"
                                                transform="rotate(180 26.4157 1.4202)"
                                                fill="#38679D" />
                                        <circle cx="13.9177"
                                                cy="87.4849"
                                                r="1.42021"
                                                transform="rotate(180 13.9177 87.4849)"
                                                fill="#38679D" />
                                        <circle cx="13.9177"
                                                cy="74.9871"
                                                r="1.42021"
                                                transform="rotate(180 13.9177 74.9871)"
                                                fill="#38679D" />
                                        <circle cx="13.9177"
                                                cy="62.4892"
                                                r="1.42021"
                                                transform="rotate(180 13.9177 62.4892)"
                                                fill="#38679D" />
                                        <circle cx="13.9177"
                                                cy="38.3457"
                                                r="1.42021"
                                                transform="rotate(180 13.9177 38.3457)"
                                                fill="#38679D" />
                                        <circle cx="13.9177"
                                                cy="13.634"
                                                r="1.42021"
                                                transform="rotate(180 13.9177 13.634)"
                                                fill="#38679D" />
                                        <circle cx="13.9177"
                                                cy="50.2754"
                                                r="1.42021"
                                                transform="rotate(180 13.9177 50.2754)"
                                                fill="#38679D" />
                                        <circle cx="13.9177"
                                                cy="26.1319"
                                                r="1.42021"
                                                transform="rotate(180 13.9177 26.1319)"
                                                fill="#38679D" />
                                        <circle cx="13.9177"
                                                cy="1.42019"
                                                r="1.42021"
                                                transform="rotate(180 13.9177 1.42019)"
                                                fill="#38679D" />
                                        <circle cx="1.41963"
                                                cy="87.4849"
                                                r="1.42021"
                                                transform="rotate(180 1.41963 87.4849)"
                                                fill="#38679D" />
                                        <circle cx="1.41963"
                                                cy="74.9871"
                                                r="1.42021"
                                                transform="rotate(180 1.41963 74.9871)"
                                                fill="#38679D" />
                                        <circle cx="1.41963"
                                                cy="62.4892"
                                                r="1.42021"
                                                transform="rotate(180 1.41963 62.4892)"
                                                fill="#38679D" />
                                        <circle cx="1.41963"
                                                cy="38.3457"
                                                r="1.42021"
                                                transform="rotate(180 1.41963 38.3457)"
                                                fill="#38679D" />
                                        <circle cx="1.41963"
                                                cy="13.634"
                                                r="1.42021"
                                                transform="rotate(180 1.41963 13.634)"
                                                fill="#38679D" />
                                        <circle cx="1.41963"
                                                cy="50.2754"
                                                r="1.42021"
                                                transform="rotate(180 1.41963 50.2754)"
                                                fill="#38679D" />
                                        <circle cx="1.41963"
                                                cy="26.1319"
                                                r="1.42021"
                                                transform="rotate(180 1.41963 26.1319)"
                                                fill="#38679D" />
                                        <circle cx="1.41963"
                                                cy="1.4202"
                                                r="1.42021"
                                                transform="rotate(180 1.41963 1.4202)"
                                                fill="#38679D" />
                                    </svg>
                                </span>
                            </div>
                        </div>
                    </div>
                    }
            </div>
            }
        </div>
    </section>
}
<section id="success" class="bg-gray-2 py-[60px] dark:bg-dark fixed bottom-0 right-1 lg:right-5 hidden z-50"
         x-data="{ toastOpen: true, timer: null }"
         x-init="timer=setTimeout(() =>
                            {
                            toastOpen = false;
                            }, 5000);
        "
         x-on:click.away="clearTimeout(timer);
                            toastOpen = false;
        "
         x-on:mouseover="clearTimeout(timer)"
         x-on:mouseout="timer = setTimeout(() => {
                            toastOpen = false;
                            }, 5000);
        "
         :class="toastOpen ? 'block' : 'hidden'">
    <div class="mx-auto px-4 sm:container">
        <div class="relative flex min-w-[350px] lg:min-w-[450px] items-center rounded-lg border border-gray-200 bg-white p-4 py-[18px] shadow-xl sm:px-[30px] dark:border-dark-3 dark:bg-dark-2 dark:shadow-box-dark">
            <div class="mr-5 flex h-10 w-full max-w-[40px] items-center justify-center rounded-full bg-[#38679D]">
                <svg width="24"
                        height="25"
                        viewBox="0 0 24 25"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 1.17499C5.7375 1.17499 0.675003 6.23749 0.675003 12.5C0.675003 18.7625 5.7375 23.8625 12 23.8625C18.2625 23.8625 23.3625 18.7625 23.3625 12.5C23.3625 6.23749 18.2625 1.17499 12 1.17499ZM12 22.175C6.675 22.175 2.3625 17.825 2.3625 12.5C2.3625 7.17499 6.675 2.86249 12 2.86249C17.325 2.86249 21.675 7.21249 21.675 12.5375C21.675 17.825 17.325 22.175 12 22.175Z"
                            fill="white" />
                    <path d="M15.225 9.01248L10.7625 13.3625L8.7375 11.375C8.4 11.0375 7.875 11.075 7.5375 11.375C7.2 11.7125 7.2375 12.2375 7.5375 12.575L9.9375 14.9C10.1625 15.125 10.4625 15.2375 10.7625 15.2375C11.0625 15.2375 11.3625 15.125 11.5875 14.9L16.425 10.25C16.7625 9.91248 16.7625 9.38748 16.425 9.04998C16.0875 8.71248 15.5625 8.71248 15.225 9.01248Z"
                            fill="white" />
                </svg>
            </div>
            <div class="flex w-full items-center justify-between">
                <div>
                    <h6 class="text-base font-semibold text-dark sm:text-lg dark:text-white">
                        Ottimo!
                    </h6>
                    <p class="text-sm text-body-color dark:text-dark-6 text-nowrap">
                        Prodotto aggiunto al carrello.
                    </p>
                </div>

                <button class="text-dark-5 hover:text-red cursor-pointer" onclick="closeSuccess()">
                    <svg width="18"
                         height="18"
                         viewBox="0 0 18 18"
                         fill="none"
                         xmlns="http://www.w3.org/2000/svg"
                         class="fill-current">
                        <path d="M9.9 9.00001L16.7625 2.13751C17.0156 1.88439 17.0156 1.49064 16.7625 1.23751C16.5094 0.984387 16.1156 0.984387 15.8625 1.23751L9 8.10001L2.1375 1.23751C1.88437 0.984387 1.49062 0.984387 1.2375 1.23751C0.984372 1.49064 0.984372 1.88439 1.2375 2.13751L8.1 9.00001L1.2375 15.8625C0.984372 16.1156 0.984372 16.5094 1.2375 16.7625C1.35 16.875 1.51875 16.9594 1.6875 16.9594C1.85625 16.9594 2.025 16.9031 2.1375 16.7625L9 9.90001L15.8625 16.7625C15.975 16.875 16.1437 16.9594 16.3125 16.9594C16.4812 16.9594 16.65 16.9031 16.7625 16.7625C17.0156 16.5094 17.0156 16.1156 16.7625 15.8625L9.9 9.00001Z" />
                    </svg>
                </button>
            </div>
        </div>
    </div>
</section>
<section id="error" class="bg-gray-2 py-[60px] dark:bg-dark fixed bottom-0 right-1 lg:right-5 hidden z-50"
         x-data="{ toastErrorOpen: true, errorTimer: null }"
         x-init="errorTimer=setTimeout(() =>
                            {
                            toastErrorOpen = false;
                            }, 5000);
        "
         x-on:click.away="clearTimeout(errorTimer);
                            toastErrorOpen = false;
        "
         x-on:mouseover="clearTimeout(errorTimer)"
         x-on:mouseout="errorTimer = setTimeout(() => {
                            toastErrorOpen = false;
                            }, 5000);
        "
         :class="toastErrorOpen ? 'block' : 'hidden'">
    <div class="mx-auto px-4 sm:container">
        <div class="relative flex min-w-[350px] lg:min-w-[450px] items-center rounded-lg border border-gray-200 bg-white p-4 py-[18px] shadow-xl sm:px-[30px] dark:border-dark-3 dark:bg-dark-2 dark:shadow-box-dark">
            <div class="mr-5 flex h-10 w-full max-w-[40px] items-center justify-center rounded-full bg-red-500">
                <svg width="24"
                     height="25"
                     viewBox="0 0 24 25"
                     fill="none"
                     xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 1.17499C5.7375 1.17499 0.675003 6.23749 0.675003 12.5C0.675003 18.7625 5.7375 23.8625 12 23.8625C18.2625 23.8625 23.3625 18.7625 23.3625 12.5C23.3625 6.23749 18.2625 1.17499 12 1.17499ZM12 22.175C6.675 22.175 2.3625 17.825 2.3625 12.5C2.3625 7.17499 6.675 2.86249 12 2.86249C17.325 2.86249 21.675 7.21249 21.675 12.5375C21.675 17.825 17.325 22.175 12 22.175Z"
                          fill="white" />
                    <path d="M15.5625 9.43751C15.3094 9.18439 14.9156 9.18439 14.6625 9.43751L12 12.1L9.3375 9.43751C9.08437 9.18439 8.69062 9.18439 8.4375 9.43751C8.18437 9.69064 8.18437 10.0844 8.4375 10.3375L11.1 13L8.4375 15.6625C8.18437 15.9156 8.18437 16.3094 8.4375 16.5625C8.55 16.675 8.71875 16.7594 8.8875 16.7594C9.05625 16.7594 9.225 16.7031 9.3375 16.5625L12 13.9L14.6625 16.5625C14.775 16.675 14.9437 16.7594 15.1125 16.7594C15.2812 16.7594 15.45 16.7031 15.5625 16.5625C15.8156 16.3094 15.8156 15.9156 15.5625 15.6625L12.9 13L15.5625 10.3375C15.8156 10.0844 15.8156 9.69064 15.5625 9.43751Z"
                          fill="white" />
                </svg>
            </div>
            <div class="flex w-full items-center justify-between">
                <div>
                    <h6 class="text-base font-semibold text-dark sm:text-lg dark:text-white">
                        Attenzione!
                    </h6>
                    <p class="text-sm text-body-color dark:text-dark-6 text-nowrap">
                        Errore durante il processo.
                    </p>
                </div>

                <button class="text-dark-5 hover:text-red cursor-pointer" onclick="closeError()">
                    <svg width="18"
                         height="18"
                         viewBox="0 0 18 18"
                         fill="none"
                         xmlns="http://www.w3.org/2000/svg"
                         class="fill-current">
                        <path d="M9.9 9.00001L16.7625 2.13751C17.0156 1.88439 17.0156 1.49064 16.7625 1.23751C16.5094 0.984387 16.1156 0.984387 15.8625 1.23751L9 8.10001L2.1375 1.23751C1.88437 0.984387 1.49062 0.984387 1.2375 1.23751C0.984372 1.49064 0.984372 1.88439 1.2375 2.13751L8.1 9.00001L1.2375 15.8625C0.984372 16.1156 0.984372 16.5094 1.2375 16.7625C1.35 16.875 1.51875 16.9594 1.6875 16.9594C1.85625 16.9594 2.025 16.9031 2.1375 16.7625L9 9.90001L15.8625 16.7625C15.975 16.875 16.1437 16.9594 16.3125 16.9594C16.4812 16.9594 16.65 16.9031 16.7625 16.7625C17.0156 16.5094 17.0156 16.1156 16.7625 15.8625L9.9 9.00001Z" />
                    </svg>
                </button>
            </div>
        </div>
    </div>
</section>

<script defer>
    const wordLimit = document.getElementById('wordLimit');
    const messageArea = document.getElementById('messageArea');

    if(wordLimit != null && messageArea != null) {
        wordLimit.addEventListener('change', updateWordLimit);
        messageArea.addEventListener('input', checkWordCount);

        function updateWordLimit() {
          const selectedOption = wordLimit.options[wordLimit.selectedIndex];
          const price = selectedOption.getAttribute('data-price');
          const limit = wordLimit.value === '90' ? Infinity : parseInt(wordLimit.value);
          messageArea.setAttribute('data-word-limit', limit);
          messageArea.setAttribute('data-price', price);
          checkWordCount();
        }

        function checkWordCount() {
          const words = messageArea.value.trim().split(/\s+/);
          const limit = parseInt(messageArea.getAttribute('data-word-limit')) || Infinity;

          if (words.length > limit && limit !== Infinity) {
            messageArea.value = words.slice(0, limit).join(' ');
          }
        }

        updateWordLimit();
    }
</script>
<script defer>
    document.addEventListener('DOMContentLoaded', function () {
        document.getElementById('submitBtn').addEventListener('click', function (e) {
            e.preventDefault(); 

            const form = document.getElementById('dataForm');
            if (form != null && !form.checkValidity()) {
                form.reportValidity();
                return;
            }

            const datepickers = document.querySelectorAll('.datepicker');
            datepickers.forEach(datepicker => {
                datepicker.addEventListener('input', function() {
                    this.setCustomValidity('');
                });
            });
            let selectedDates = [];

            if (datepickers != null && datepickers.length > 0) {
                let allValid = true;
                datepickers.forEach(datepicker => {
                    if (!datepicker.value) {
                        allValid = false;
                        datepicker.setCustomValidity('Compila questo campo');
                        datepicker.reportValidity();
                    } else {
                        datepicker.setCustomValidity('');
                        var item = { Data: datepicker.value, ProdottoId: @Html.Raw(Json.Encode(Model.Id)) };
                        selectedDates.push(item);
                    }
                });

                if (!allValid) {
                    return;
                } else {
                    selectedDates = selectedDates.map(dateString => {
                        return {
                            Data: formatDateForBackend(dateString.Data),
                            ProdottoId: dateString.ProdottoId
                        }
                    });
                }
            }

            const selectedWeekday = document.querySelector('input[name="giorno"]:checked')?.value;

            const messageArea = document.getElementById('messageArea');
            let messageAreaText = null;
            let messageAreaPrice = null;
            if (messageArea) {
                messageAreaText = messageArea.value;
                messageAreaPrice = messageArea.getAttribute('data-price');
            }
            const infoArea = document.getElementById('infoArea')?.value;
            const flowerArea = document.getElementById('flowerArea')?.value;

            const indirizzo = document.getElementById('cemeterySearch')?.value;
            const nomeDestinatario = document.getElementById('nomeDestinatario')?.value;
            const cognomeDestinatario = document.getElementById('cognomeDestinatario')?.value;
            const dataNascita = document.getElementById('dataNascita')?.value;
            const dataMorte = document.getElementById('dataMorte')?.value;
            const selectProduct = document.getElementById('selectProduct')?.value;

            let selectedProducts = [];
            const productsChecked = Array.from(document.querySelectorAll('.product-checkbox:checked'))
                                        .map(checkbox => {
                                            const category = @Html.Raw(Json.Encode(Model.Categoria));
                                            const price = parseFloat(checkbox.dataset.price.replace(',', '.'));
                                            const numeroAbbonamento = @Html.Raw(Json.Encode(Model.NumeroConsegneAbbonamento));
                                            const quantityMultiplier = numeroAbbonamento ? parseInt(numeroAbbonamento, 10) : 1;
                                            const abbonamentoId = numeroAbbonamento ? @Html.Raw(Json.Encode(Model.Id)) : null;
                                            const groupId = crypto.randomUUID();

                                            return {
                                                ProdottoId: checkbox.dataset.id,
                                                Categoria: category,
                                                Prezzo: quantityMultiplier > 1
                                                    ? price * quantityMultiplier
                                                    : (category !== 3 && category !== 4)
                                                    ? price
                                                    : 0,
                                                Abbonamento: quantityMultiplier > 1,
                                                AbbonamentoId : abbonamentoId,
                                                SelectedDates: selectedDates,
                                                SelectedWeekday: selectedWeekday,
                                                NotaConsegna: infoArea,
                                                NotaFiori: flowerArea,
                                                Messaggio: messageAreaText,
                                                NomeDestinatario: nomeDestinatario,
                                                CognomeDestinatario: cognomeDestinatario,
                                                Indirizzo: indirizzo,
                                                GroupId: groupId,
                                                DataNascita: dataNascita,
                                                DataMorte: dataMorte,
                                                SelProduct: selectProduct
                                            };
                                        });

            if (productsChecked.length) {
                selectedProducts = productsChecked;
            }
            else{
                const quantity = document.getElementById('quantity')?.value;
                const color = document.querySelector('input[name="color"]:checked')?.value;
                const categoria = parseInt(@Html.Raw(Json.Encode(Model.Categoria)),10);
                const price = messageAreaPrice != null ? parseFloat(messageAreaPrice.replace(",",".")) : @Html.Raw(Json.Encode(Model.Prezzo));
                selectedProducts = [{
                    ProdottoId: @Html.Raw(Json.Encode(Model.Id)),
                    Quantita: parseInt(quantity, 10),
                    Colore: color,
                    Prezzo: price,
                    Categoria: categoria,
                    SelectedDates: selectedDates,
                    SelectedWeekday: selectedWeekday,
                    NotaConsegna: infoArea,
                    NotaFiori: flowerArea,
                    Messaggio: messageAreaText,
                    NomeDestinatario: nomeDestinatario,
                    CognomeDestinatario: cognomeDestinatario,
                    Indirizzo: indirizzo,
                    DataNascita: dataNascita,
                    DataMorte: dataMorte,
                    SelProduct: selectProduct
                }];
            }

            const dto = {
                SelectedProducts: selectedProducts
            };
            console.log(dto);

            fetch('/Cart/AddToCart', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(dto)
            })
            .then(response => {
                if (response.ok) {
                    console.log('Dati inviati con successo!');

                    document.querySelectorAll('.product-checkbox:checked').forEach(checkbox => {
                        checkbox.checked = false;
                    });

                    const quantitySelect = document.getElementById('quantity');
                    if (quantitySelect) {
                        quantitySelect.selectedIndex = 0;
                    }

                    const selectedColor = document.querySelector('input[name="color"]:checked');
                    if (selectedColor) {
                        selectedColor.checked = false;
                    }

                    document.querySelectorAll('.datepicker').forEach(datepicker => {
                        datepicker.value = '';
                    });

                    const weekdaySelect = document.getElementById('selectedWeekday');
                    if (weekdaySelect) {
                        weekdaySelect.selectedIndex = 0;
                    }

                    const messageArea = document.getElementById('messageArea');
                    if (messageArea) {
                        messageArea.value = '';
                    }

                    const infoArea = document.getElementById('infoArea');
                    if (infoArea) {
                        infoArea.value = '';
                    }

                    const flowerArea = document.getElementById('flowerArea');
                    if (flowerArea) {
                        flowerArea.value = '';
                    }

                    const indirizzo = document.getElementById('cemeterySearch');
                    if (indirizzo) {
                        indirizzo.value = '';
                    }

                    const nomeDestinatario = document.getElementById('nomeDestinatario');
                    if (nomeDestinatario) {
                        nomeDestinatario.value = '';
                    }

                    const cognomeDestinatario = document.getElementById('cognomeDestinatario');
                    if (cognomeDestinatario) {
                        cognomeDestinatario.value = '';
                    }

                    const dataNascita = document.getElementById('dataNascita');
                    if (dataNascita){
                        dataNascita.value = '';
                    }
                    
                    const dataMorte = document.getElementById('dataMorte');
                    if (dataMorte){
                        dataMorte.value = '';
                    }

                    const selProduct = document.getElementById('selectedProduct');
                    if (selProduct){
                        selProduct.value = '';
                    }

                    const success = document.getElementById('success');
                    if(success){
                        success.classList.remove('hidden');
                    }
                } else {
                    console.error(response);
                    const error =document.getElementById('error');
                    if(error){
                        error.classList.remove('hidden');
                    }
                }
            })
            .catch(error => {
                console.error('Errore di rete:', error);
            });
        });
    });

    function closeSuccess(){
        const success = document.getElementById('success');
        if(success)
            success.classList.add('hidden');
    }

    function closeError(){
        const error = document.getElementById('error');
        if(error)
            error.classList.add('hidden');
    }

    function formatDateForBackend(dateString) {
        const [day, month, year] = dateString.split('-');
        return new Date(`${year}-${month}-${day}T00:00:00`);
    }

</script>
<script async
        src="https://maps.googleapis.com/maps/api/js?key=@apiKey&loading=async&libraries=places&callback=initMap">
</script>
<script>
    function initMap(){
        const cemeterySearch = document.getElementById('cemeterySearch');
        const searchResults = document.getElementById('searchResults');

        if(searchResults != null) {
            searchResults.style.display = 'none';

            const autocomplete = new google.maps.places.Autocomplete(cemeterySearch, {
                componentRestrictions: { country: 'it' }
            });

            autocomplete.addListener('place_changed', () => {
                const place = autocomplete.getPlace();
                if (!place.geometry) {
                    searchResults.innerHTML = '<div class="p-3 text-gray-500">Nessun risultato trovato</div>';
                    searchResults.style.display = 'block';
                    return;
                }

                searchResults.style.display = 'none';
            });

            cemeterySearch.addEventListener('input', () => {
                if (cemeterySearch.value.length < 3) {
                    searchResults.style.display = 'none';
                }
            });

            document.addEventListener('click', (e) => {
                if (!e.target.closest('#inputSearch')) {
                    searchResults.style.display = 'none';
                }
            });
        }
    }
</script>
