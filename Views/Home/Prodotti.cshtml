@model IEnumerable<FloreMoria.Models.Prodotto>
@using FloreMoria.Enums
@using System.Text.RegularExpressions

@{
    ViewBag.Title = ViewBag.Title ?? "Prodotti";
    var datiEsterni = ViewBag.DatiEsterni as Floremoria.Dto.ExternalDataDto;
}

<style>
    .great-vibes {
        font-family: "Great Vibes", serif;
        font-weight: 400;
        font-style: normal;
    }

    .navbar .navbar-brand,
    .navbar .nav-link {
        color: #369;
    }

        .navbar .nav-link:hover, .cart:hover {
            color: white;
        }

    .detail:hover {
        color: #38679D;
    }
</style>

<div class="pt-24">
    <div class="w-full px-12 my-5">
        <div class="mx-auto mb-12 max-w-[750px] text-center lg:mb-20">
            @*<span class="text-[#38679D] mb-2 block text-lg font-semibold">
                    I nostri prodotti
                </span>*@
            <h2 class="text-dark dark:text-white mb-3 text-3xl leading-[1.2] font-bold sm:text-4xl md:text-[40px]">
                @ViewBag.Title
            </h2>
            <p class="text-body-color dark:text-dark-6">
                @ViewBag.Descrizione
            </p>
        </div>
    </div>
</div>
@if(ViewBag.DatiEsterni != null)
{
    <div class="pt-5">
        <div class="w-full px-12 my-5">
            <div class="mx-auto max-w-[750px] text-center bg-blue-200/40 rounded">
                <p class="text-body-color text-xl">
                    Stai scegliendo l'omaggio floreale per @datiEsterni.NomeDefunto @datiEsterni.CognomeDefunto
                    <br />tramite @datiEsterni.RedirectUrl
                </p>
            </div>
        </div>
    </div>
}
@if (Model != null)
{
    <div class="lg:mx-7 lg:bg-blue-200/40 mb-12 lg:py-12">
        <div class="flex flex-wrap justify-center items-stretch mx-auto @(Model.Any(x => x.Categoria == Categoria.Abbonamento || x.Categoria == Categoria.Carnet) ? "lg:px-5" : "lg:container")">
            @if (Model.Any(x => x.Categoria != Categoria.Carnet && x.Categoria != Categoria.Abbonamento))
            {
                foreach (var item in Model)
                {
                    <a href="@Url.Action("Dettaglio", "Home", new { id = item.Id, externalKey = Request.QueryString["externalKey"] })">
                        <div class="w-full md:w-1/2 lg:w-1/4 pl-5 pr-5 lg:pl-2 lg:pr-2 mb-12 lg:mb-5 flex">
                            <div class="bg-[url(@item.Immagine)] rounded-lg m-h-64 p-2 transform hover:translate-y-2 shadow-lg hover:shadow-2xl transition duration-300 flex flex-col w-full">
                                <figure class="mb-2 flex-shrink-0">

                                    <img src="@item.Immagine" alt="" class="lg:h-64 w-full lg:object-cover" />
                                </figure>
                                <div class="rounded-lg p-4 bg-[#38679D] flex flex-col flex-grow">
                                    <div class="flex-grow">
                                        <h5 class="text-white text-2xl font-bold leading-none">
                                            @item.Nome
                                        </h5>
                                        <span class="text-sm text-gray-200 leading-none line-clamp-2 overflow-hidden text-ellipsis mt-2">@item.Descrizione</span>
                                    </div>
                                    <div class="flex items-center mt-3">
                                        <div class="text-lg text-white font-light">
                                            @if ((item.Categoria == Categoria.Lutto && item.Prezzo < 10) || (item.Categoria == Categoria.Altro && item.Prezzo < 3))
                                            {
                                                <span>a partire da</span> @item.Prezzo <span>€</span>
                                            }
                                            else
                                            {
                                                @item.Prezzo <span>€</span>
                                            }
                                        </div>
                                        <a href="@Url.Action("Dettaglio", "Home", new { id = item.Id, externalKey = Request.QueryString["externalKey"] })" class="detail rounded-full bg-blue-300 text-white hover:bg-white hover:text-[#38679D] hover:shadow-xl hover:cursor-pointer focus:outline-none w-10 h-10 flex ml-auto transition duration-300">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="stroke-current m-auto">
                                                <line x1="5" y1="12" x2="19" y2="12"></line>
                                                <polyline points="12 5 19 12 12 19"></polyline>
                                            </svg>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </a>
                }
            }
            else if (Model.Any(x => x.Categoria == Categoria.Carnet))
            {
                foreach (var item in Model)
                {
                    <div class="w-full px-4 md:w-1/2 lg:w-1/4 mb-12 lg:mb-0">
                        <div class="relative z-10 overflow-hidden rounded-[10px] border-2 border-stroke dark:border-dark-3 bg-white dark:bg-dark-2 py-10 px-8 shadow-pricing sm:p-12 lg:py-10 lg:px-6 xl:p-[50px]">
                            <img src="@item.Immagine" alt="immagine" class="w-full mb-4" />
                            <span class="mb-3 block text-lg font-semibold text-primary">
                                @item.Nome
                            </span>
                            <h2 class="mb-5 text-[42px] font-bold text-dark dark:text-white">
                                <span>€ @item.Prezzo</span>
                            </h2>
                            <p class="mb-8 border-b border-stroke dark:border-dark-3 pb-8 text-base text-body-color dark:text-dark-6">
                                @item.Descrizione
                            </p>
                            <ul class="space-y-3 mt-3 mb-7">
                                <li class="text-body-color dark:text-dark-6 flex text-base">
                                    <span class="text-primary mr-2.5 mt-0.5">
                                        <svg width="20"
                                             height="20"
                                             viewBox="0 0 20 20"
                                             fill="none"
                                             xmlns="http://www.w3.org/2000/svg">
                                            <g clip-path="url(#clip0_980_24852)">
                                                <path d="M10 0.5625C4.78125 0.5625 0.5625 4.78125 0.5625 10C0.5625 15.2188 4.78125 19.4688 10 19.4688C15.2188 19.4688 19.4688 15.2188 19.4688 10C19.4688 4.78125 15.2188 0.5625 10 0.5625ZM10 18.0625C5.5625 18.0625 1.96875 14.4375 1.96875 10C1.96875 5.5625 5.5625 1.96875 10 1.96875C14.4375 1.96875 18.0625 5.59375 18.0625 10.0312C18.0625 14.4375 14.4375 18.0625 10 18.0625Z"
                                                      fill="currentColor" />
                                                <path d="M12.6875 7.09375L8.96875 10.7188L7.28125 9.0625C7 8.78125 6.5625 8.8125 6.28125 9.0625C6 9.34375 6.03125 9.78125 6.28125 10.0625L8.28125 12C8.46875 12.1875 8.71875 12.2813 8.96875 12.2813C9.21875 12.2813 9.46875 12.1875 9.65625 12L13.6875 8.125C13.9688 7.84375 13.9688 7.40625 13.6875 7.125C13.4063 6.84375 12.9688 6.84375 12.6875 7.09375Z"
                                                      fill="currentColor" />
                                            </g>
                                            <defs>
                                                <clipPath id="clip0_980_24852">
                                                    <rect width="20" height="20" fill="white" />
                                                </clipPath>
                                            </defs>
                                        </svg>
                                    </span>
                                    <span>
                                        Scegli la data di consegna quando vuoi senza scadenza.
                                    </span>
                                </li>
                                <li class="text-body-color dark:text-dark-6 flex text-base">
                                    <span class="text-primary mr-2.5 mt-0.5">
                                        <svg width="20"
                                             height="20"
                                             viewBox="0 0 20 20"
                                             fill="none"
                                             xmlns="http://www.w3.org/2000/svg">
                                            <g clip-path="url(#clip0_980_24852)">
                                                <path d="M10 0.5625C4.78125 0.5625 0.5625 4.78125 0.5625 10C0.5625 15.2188 4.78125 19.4688 10 19.4688C15.2188 19.4688 19.4688 15.2188 19.4688 10C19.4688 4.78125 15.2188 0.5625 10 0.5625ZM10 18.0625C5.5625 18.0625 1.96875 14.4375 1.96875 10C1.96875 5.5625 5.5625 1.96875 10 1.96875C14.4375 1.96875 18.0625 5.59375 18.0625 10.0312C18.0625 14.4375 14.4375 18.0625 10 18.0625Z"
                                                      fill="currentColor" />
                                                <path d="M12.6875 7.09375L8.96875 10.7188L7.28125 9.0625C7 8.78125 6.5625 8.8125 6.28125 9.0625C6 9.34375 6.03125 9.78125 6.28125 10.0625L8.28125 12C8.46875 12.1875 8.71875 12.2813 8.96875 12.2813C9.21875 12.2813 9.46875 12.1875 9.65625 12L13.6875 8.125C13.9688 7.84375 13.9688 7.40625 13.6875 7.125C13.4063 6.84375 12.9688 6.84375 12.6875 7.09375Z"
                                                      fill="currentColor" />
                                            </g>
                                            <defs>
                                                <clipPath id="clip0_980_24852">
                                                    <rect width="20" height="20" fill="white" />
                                                </clipPath>
                                            </defs>
                                        </svg>
                                    </span>
                                    <span>
                                        Puoi scegliere anche più tombe in tutta Italia.
                                    </span>
                                </li>
                                <li class="text-body-color dark:text-dark-6 flex text-base">
                                    <span class="text-primary mr-2.5 mt-0.5">
                                        <svg width="20"
                                             height="20"
                                             viewBox="0 0 20 20"
                                             fill="none"
                                             xmlns="http://www.w3.org/2000/svg">
                                            <g clip-path="url(#clip0_980_24852)">
                                                <path d="M10 0.5625C4.78125 0.5625 0.5625 4.78125 0.5625 10C0.5625 15.2188 4.78125 19.4688 10 19.4688C15.2188 19.4688 19.4688 15.2188 19.4688 10C19.4688 4.78125 15.2188 0.5625 10 0.5625ZM10 18.0625C5.5625 18.0625 1.96875 14.4375 1.96875 10C1.96875 5.5625 5.5625 1.96875 10 1.96875C14.4375 1.96875 18.0625 5.59375 18.0625 10.0312C18.0625 14.4375 14.4375 18.0625 10 18.0625Z"
                                                      fill="currentColor" />
                                                <path d="M12.6875 7.09375L8.96875 10.7188L7.28125 9.0625C7 8.78125 6.5625 8.8125 6.28125 9.0625C6 9.34375 6.03125 9.78125 6.28125 10.0625L8.28125 12C8.46875 12.1875 8.71875 12.2813 8.96875 12.2813C9.21875 12.2813 9.46875 12.1875 9.65625 12L13.6875 8.125C13.9688 7.84375 13.9688 7.40625 13.6875 7.125C13.4063 6.84375 12.9688 6.84375 12.6875 7.09375Z"
                                                      fill="currentColor" />
                                            </g>
                                            <defs>
                                                <clipPath id="clip0_980_24852">
                                                    <rect width="20" height="20" fill="white" />
                                                </clipPath>
                                            </defs>
                                        </svg>
                                    </span>
                                    <span>
                                        Un bouquet omaggio subito da inviare dove vuoi.
                                    </span>
                                </li>
                            </ul>
                            <a onclick="addToCart('@item.Id', @Html.Raw(Json.Encode(item.Prezzo)), @Html.Raw(Json.Encode(item.Categoria)))"
                               class="cart block w-full rounded-md border border-stroke dark:border-dark-3 bg-[#38679D] p-3 text-center text-base font-medium text-white transition hover:border-[#38679D]/90 hover:bg-[#38679D]/90 hover:text-white cursor-pointer">
                                Acquista carnet
                            </a>
                            <div>
                                <span class="absolute right-0 top-7 z-[-1]">
                                    <svg width="77"
                                         height="172"
                                         viewBox="0 0 77 172"
                                         fill="none"
                                         xmlns="http://www.w3.org/2000/svg">
                                        <circle cx="86" cy="86" r="86" fill="url(#paint0_linear)" />
                                        <defs>
                                            <linearGradient id="paint0_linear"
                                                            x1="86"
                                                            y1="0"
                                                            x2="86"
                                                            y2="172"
                                                            gradientUnits="userSpaceOnUse">
                                                <stop stop-color="#3056D3" stop-opacity="0.09" />
                                                <stop offset="1"
                                                      stop-color="#C4C4C4"
                                                      stop-opacity="0" />
                                            </linearGradient>
                                        </defs>
                                    </svg>
                                </span>
                                <span class="absolute right-4 top-4 z-[-1]">
                                    <svg width="41"
                                         height="89"
                                         viewBox="0 0 41 89"
                                         fill="none"
                                         xmlns="http://www.w3.org/2000/svg">
                                        <circle cx="38.9138"
                                                cy="87.4849"
                                                r="1.42021"
                                                transform="rotate(180 38.9138 87.4849)"
                                                fill="#3056D3" />
                                        <circle cx="38.9138"
                                                cy="74.9871"
                                                r="1.42021"
                                                transform="rotate(180 38.9138 74.9871)"
                                                fill="#3056D3" />
                                        <circle cx="38.9138"
                                                cy="62.4892"
                                                r="1.42021"
                                                transform="rotate(180 38.9138 62.4892)"
                                                fill="#3056D3" />
                                        <circle cx="38.9138"
                                                cy="38.3457"
                                                r="1.42021"
                                                transform="rotate(180 38.9138 38.3457)"
                                                fill="#3056D3" />
                                        <circle cx="38.9138"
                                                cy="13.634"
                                                r="1.42021"
                                                transform="rotate(180 38.9138 13.634)"
                                                fill="#3056D3" />
                                        <circle cx="38.9138"
                                                cy="50.2754"
                                                r="1.42021"
                                                transform="rotate(180 38.9138 50.2754)"
                                                fill="#3056D3" />
                                        <circle cx="38.9138"
                                                cy="26.1319"
                                                r="1.42021"
                                                transform="rotate(180 38.9138 26.1319)"
                                                fill="#3056D3" />
                                        <circle cx="38.9138"
                                                cy="1.42021"
                                                r="1.42021"
                                                transform="rotate(180 38.9138 1.42021)"
                                                fill="#3056D3" />
                                        <circle cx="26.4157"
                                                cy="87.4849"
                                                r="1.42021"
                                                transform="rotate(180 26.4157 87.4849)"
                                                fill="#3056D3" />
                                        <circle cx="26.4157"
                                                cy="74.9871"
                                                r="1.42021"
                                                transform="rotate(180 26.4157 74.9871)"
                                                fill="#3056D3" />
                                        <circle cx="26.4157"
                                                cy="62.4892"
                                                r="1.42021"
                                                transform="rotate(180 26.4157 62.4892)"
                                                fill="#3056D3" />
                                        <circle cx="26.4157"
                                                cy="38.3457"
                                                r="1.42021"
                                                transform="rotate(180 26.4157 38.3457)"
                                                fill="#3056D3" />
                                        <circle cx="26.4157"
                                                cy="13.634"
                                                r="1.42021"
                                                transform="rotate(180 26.4157 13.634)"
                                                fill="#3056D3" />
                                        <circle cx="26.4157"
                                                cy="50.2754"
                                                r="1.42021"
                                                transform="rotate(180 26.4157 50.2754)"
                                                fill="#3056D3" />
                                        <circle cx="26.4157"
                                                cy="26.1319"
                                                r="1.42021"
                                                transform="rotate(180 26.4157 26.1319)"
                                                fill="#3056D3" />
                                        <circle cx="26.4157"
                                                cy="1.4202"
                                                r="1.42021"
                                                transform="rotate(180 26.4157 1.4202)"
                                                fill="#3056D3" />
                                        <circle cx="13.9177"
                                                cy="87.4849"
                                                r="1.42021"
                                                transform="rotate(180 13.9177 87.4849)"
                                                fill="#3056D3" />
                                        <circle cx="13.9177"
                                                cy="74.9871"
                                                r="1.42021"
                                                transform="rotate(180 13.9177 74.9871)"
                                                fill="#3056D3" />
                                        <circle cx="13.9177"
                                                cy="62.4892"
                                                r="1.42021"
                                                transform="rotate(180 13.9177 62.4892)"
                                                fill="#3056D3" />
                                        <circle cx="13.9177"
                                                cy="38.3457"
                                                r="1.42021"
                                                transform="rotate(180 13.9177 38.3457)"
                                                fill="#3056D3" />
                                        <circle cx="13.9177"
                                                cy="13.634"
                                                r="1.42021"
                                                transform="rotate(180 13.9177 13.634)"
                                                fill="#3056D3" />
                                        <circle cx="13.9177"
                                                cy="50.2754"
                                                r="1.42021"
                                                transform="rotate(180 13.9177 50.2754)"
                                                fill="#3056D3" />
                                        <circle cx="13.9177"
                                                cy="26.1319"
                                                r="1.42021"
                                                transform="rotate(180 13.9177 26.1319)"
                                                fill="#3056D3" />
                                        <circle cx="13.9177"
                                                cy="1.42019"
                                                r="1.42021"
                                                transform="rotate(180 13.9177 1.42019)"
                                                fill="#3056D3" />
                                        <circle cx="1.41963"
                                                cy="87.4849"
                                                r="1.42021"
                                                transform="rotate(180 1.41963 87.4849)"
                                                fill="#3056D3" />
                                        <circle cx="1.41963"
                                                cy="74.9871"
                                                r="1.42021"
                                                transform="rotate(180 1.41963 74.9871)"
                                                fill="#3056D3" />
                                        <circle cx="1.41963"
                                                cy="62.4892"
                                                r="1.42021"
                                                transform="rotate(180 1.41963 62.4892)"
                                                fill="#3056D3" />
                                        <circle cx="1.41963"
                                                cy="38.3457"
                                                r="1.42021"
                                                transform="rotate(180 1.41963 38.3457)"
                                                fill="#3056D3" />
                                        <circle cx="1.41963"
                                                cy="13.634"
                                                r="1.42021"
                                                transform="rotate(180 1.41963 13.634)"
                                                fill="#3056D3" />
                                        <circle cx="1.41963"
                                                cy="50.2754"
                                                r="1.42021"
                                                transform="rotate(180 1.41963 50.2754)"
                                                fill="#3056D3" />
                                        <circle cx="1.41963"
                                                cy="26.1319"
                                                r="1.42021"
                                                transform="rotate(180 1.41963 26.1319)"
                                                fill="#3056D3" />
                                        <circle cx="1.41963"
                                                cy="1.4202"
                                                r="1.42021"
                                                transform="rotate(180 1.41963 1.4202)"
                                                fill="#3056D3" />
                                    </svg>
                                </span>
                            </div>
                        </div>
                    </div>
                }
            }
            else if (Model.Any(x => x.Categoria == Categoria.Abbonamento))
            {
                foreach (var item in Model.OrderBy(x =>
                {
                    var numMatch = Regex.Match(x.Nome, @"\d+$");
                    return numMatch.Success ? int.Parse(numMatch.Value) : int.MaxValue;
                })
                .ThenBy(x => x.Nome))
                {
                    <div class="w-full px-4 md:w-1/2 lg:w-1/4 mb-12 lg:mb-0">
                        <div class="relative z-10 overflow-hidden rounded-[10px] border-2 border-stroke dark:border-dark-3 bg-white dark:bg-dark-2 py-10 px-8 shadow-pricing sm:p-12 lg:py-10 lg:px-6 xl:p-[50px]">
                            <span class="mb-3 block text-lg font-semibold text-primary">
                                @item.Nome
                            </span>
                            <h2 class="mb-5 text-[42px] font-bold text-dark dark:text-white">
                                <img src="@item.Immagine" alt="immagine" />
                            </h2>
                            <p class="text-base text-body-color dark:text-dark-6">
                                @item.Descrizione
                            </p>
                            @if (Model.Any(x => x.Categoria == Categoria.Abbonamento))
                            {
                                <span class="text-sm">(Lo sconto è applicato in caso di pagamento in soluzione unica.)</span>
                            }
                            <ul class="space-y-3 pt-3 mb-7 mt-4 border-t border-stroke dark:border-dark-3">
                                <li class="text-body-color dark:text-dark-6 flex text-base">
                                    <span class="text-primary mr-2.5 mt-0.5">
                                        <svg width="20"
                                             height="20"
                                             viewBox="0 0 20 20"
                                             fill="none"
                                             xmlns="http://www.w3.org/2000/svg">
                                            <g clip-path="url(#clip0_980_24852)">
                                                <path d="M10 0.5625C4.78125 0.5625 0.5625 4.78125 0.5625 10C0.5625 15.2188 4.78125 19.4688 10 19.4688C15.2188 19.4688 19.4688 15.2188 19.4688 10C19.4688 4.78125 15.2188 0.5625 10 0.5625ZM10 18.0625C5.5625 18.0625 1.96875 14.4375 1.96875 10C1.96875 5.5625 5.5625 1.96875 10 1.96875C14.4375 1.96875 18.0625 5.59375 18.0625 10.0312C18.0625 14.4375 14.4375 18.0625 10 18.0625Z"
                                                      fill="currentColor" />
                                                <path d="M12.6875 7.09375L8.96875 10.7188L7.28125 9.0625C7 8.78125 6.5625 8.8125 6.28125 9.0625C6 9.34375 6.03125 9.78125 6.28125 10.0625L8.28125 12C8.46875 12.1875 8.71875 12.2813 8.96875 12.2813C9.21875 12.2813 9.46875 12.1875 9.65625 12L13.6875 8.125C13.9688 7.84375 13.9688 7.40625 13.6875 7.125C13.4063 6.84375 12.9688 6.84375 12.6875 7.09375Z"
                                                      fill="currentColor" />
                                            </g>
                                            <defs>
                                                <clipPath id="clip0_980_24852">
                                                    <rect width="20" height="20" fill="white" />
                                                </clipPath>
                                            </defs>
                                        </svg>
                                    </span>
                                    <span>
                                        Scegli le date di consegna quando vuoi senza scadenza.
                                    </span>
                                </li>
                                <li class="text-body-color dark:text-dark-6 flex text-base">
                                    <span class="text-primary mr-2.5 mt-0.5">
                                        <svg width="20"
                                             height="20"
                                             viewBox="0 0 20 20"
                                             fill="none"
                                             xmlns="http://www.w3.org/2000/svg">
                                            <g clip-path="url(#clip0_980_24852)">
                                                <path d="M10 0.5625C4.78125 0.5625 0.5625 4.78125 0.5625 10C0.5625 15.2188 4.78125 19.4688 10 19.4688C15.2188 19.4688 19.4688 15.2188 19.4688 10C19.4688 4.78125 15.2188 0.5625 10 0.5625ZM10 18.0625C5.5625 18.0625 1.96875 14.4375 1.96875 10C1.96875 5.5625 5.5625 1.96875 10 1.96875C14.4375 1.96875 18.0625 5.59375 18.0625 10.0312C18.0625 14.4375 14.4375 18.0625 10 18.0625Z"
                                                      fill="currentColor" />
                                                <path d="M12.6875 7.09375L8.96875 10.7188L7.28125 9.0625C7 8.78125 6.5625 8.8125 6.28125 9.0625C6 9.34375 6.03125 9.78125 6.28125 10.0625L8.28125 12C8.46875 12.1875 8.71875 12.2813 8.96875 12.2813C9.21875 12.2813 9.46875 12.1875 9.65625 12L13.6875 8.125C13.9688 7.84375 13.9688 7.40625 13.6875 7.125C13.4063 6.84375 12.9688 6.84375 12.6875 7.09375Z"
                                                      fill="currentColor" />
                                            </g>
                                            <defs>
                                                <clipPath id="clip0_980_24852">
                                                    <rect width="20" height="20" fill="white" />
                                                </clipPath>
                                            </defs>
                                        </svg>
                                    </span>
                                    <span>
                                        Se la data scelta non è disponibile la consegna verrà effettuata il giorno precedente o successivo.
                                    </span>
                                </li>
                                <li class="text-body-color dark:text-dark-6 flex text-base">
                                    <span class="text-primary mr-2.5 mt-0.5">
                                        <svg width="20"
                                             height="20"
                                             viewBox="0 0 20 20"
                                             fill="none"
                                             xmlns="http://www.w3.org/2000/svg">
                                            <g clip-path="url(#clip0_980_24852)">
                                                <path d="M10 0.5625C4.78125 0.5625 0.5625 4.78125 0.5625 10C0.5625 15.2188 4.78125 19.4688 10 19.4688C15.2188 19.4688 19.4688 15.2188 19.4688 10C19.4688 4.78125 15.2188 0.5625 10 0.5625ZM10 18.0625C5.5625 18.0625 1.96875 14.4375 1.96875 10C1.96875 5.5625 5.5625 1.96875 10 1.96875C14.4375 1.96875 18.0625 5.59375 18.0625 10.0312C18.0625 14.4375 14.4375 18.0625 10 18.0625Z"
                                                      fill="currentColor" />
                                                <path d="M12.6875 7.09375L8.96875 10.7188L7.28125 9.0625C7 8.78125 6.5625 8.8125 6.28125 9.0625C6 9.34375 6.03125 9.78125 6.28125 10.0625L8.28125 12C8.46875 12.1875 8.71875 12.2813 8.96875 12.2813C9.21875 12.2813 9.46875 12.1875 9.65625 12L13.6875 8.125C13.9688 7.84375 13.9688 7.40625 13.6875 7.125C13.4063 6.84375 12.9688 6.84375 12.6875 7.09375Z"
                                                      fill="currentColor" />
                                            </g>
                                            <defs>
                                                <clipPath id="clip0_980_24852">
                                                    <rect width="20" height="20" fill="white" />
                                                </clipPath>
                                            </defs>
                                        </svg>
                                    </span>
                                    <span>
                                        Paga in un'unica soluzione scontata o mensilmente.
                                    </span>
                                </li>
                                <li class="text-body-color dark:text-dark-6 flex text-base">
                                    <span class="text-primary mr-2.5 mt-0.5">
                                        <svg width="20"
                                             height="20"
                                             viewBox="0 0 20 20"
                                             fill="none"
                                             xmlns="http://www.w3.org/2000/svg">
                                            <g clip-path="url(#clip0_980_24852)">
                                                <path d="M10 0.5625C4.78125 0.5625 0.5625 4.78125 0.5625 10C0.5625 15.2188 4.78125 19.4688 10 19.4688C15.2188 19.4688 19.4688 15.2188 19.4688 10C19.4688 4.78125 15.2188 0.5625 10 0.5625ZM10 18.0625C5.5625 18.0625 1.96875 14.4375 1.96875 10C1.96875 5.5625 5.5625 1.96875 10 1.96875C14.4375 1.96875 18.0625 5.59375 18.0625 10.0312C18.0625 14.4375 14.4375 18.0625 10 18.0625Z"
                                                      fill="currentColor" />
                                                <path d="M12.6875 7.09375L8.96875 10.7188L7.28125 9.0625C7 8.78125 6.5625 8.8125 6.28125 9.0625C6 9.34375 6.03125 9.78125 6.28125 10.0625L8.28125 12C8.46875 12.1875 8.71875 12.2813 8.96875 12.2813C9.21875 12.2813 9.46875 12.1875 9.65625 12L13.6875 8.125C13.9688 7.84375 13.9688 7.40625 13.6875 7.125C13.4063 6.84375 12.9688 6.84375 12.6875 7.09375Z"
                                                      fill="currentColor" />
                                            </g>
                                            <defs>
                                                <clipPath id="clip0_980_24852">
                                                    <rect width="20" height="20" fill="white" />
                                                </clipPath>
                                            </defs>
                                        </svg>
                                    </span>
                                    <span>
                                        Puoi disdire l'abbonamento quando vuoi.
                                    </span>
                                </li>
                            </ul>
                            <a href="/Home/Dettaglio/@item.Id"
                               class="cart block w-full rounded-md border border-stroke dark:border-dark-3 bg-[#38679D] p-3 text-center text-base font-medium text-white transition hover:border-[#38679D]/90 hover:bg-[#38679D]/90 hover:text-white">
                                Acquista abbonamento
                            </a>
                            <div>
                                <span class="absolute right-0 top-7 z-[-1]">
                                    <svg width="77"
                                         height="172"
                                         viewBox="0 0 77 172"
                                         fill="none"
                                         xmlns="http://www.w3.org/2000/svg">
                                        <circle cx="86" cy="86" r="86" fill="url(#paint0_linear)" />
                                        <defs>
                                            <linearGradient id="paint0_linear"
                                                            x1="86"
                                                            y1="0"
                                                            x2="86"
                                                            y2="172"
                                                            gradientUnits="userSpaceOnUse">
                                                <stop stop-color="#3056D3" stop-opacity="0.09" />
                                                <stop offset="1"
                                                      stop-color="#C4C4C4"
                                                      stop-opacity="0" />
                                            </linearGradient>
                                        </defs>
                                    </svg>
                                </span>
                                <span class="absolute right-4 top-4 z-[-1]">
                                    <svg width="41"
                                         height="89"
                                         viewBox="0 0 41 89"
                                         fill="none"
                                         xmlns="http://www.w3.org/2000/svg">
                                        <circle cx="38.9138"
                                                cy="87.4849"
                                                r="1.42021"
                                                transform="rotate(180 38.9138 87.4849)"
                                                fill="#3056D3" />
                                        <circle cx="38.9138"
                                                cy="74.9871"
                                                r="1.42021"
                                                transform="rotate(180 38.9138 74.9871)"
                                                fill="#3056D3" />
                                        <circle cx="38.9138"
                                                cy="62.4892"
                                                r="1.42021"
                                                transform="rotate(180 38.9138 62.4892)"
                                                fill="#3056D3" />
                                        <circle cx="38.9138"
                                                cy="38.3457"
                                                r="1.42021"
                                                transform="rotate(180 38.9138 38.3457)"
                                                fill="#3056D3" />
                                        <circle cx="38.9138"
                                                cy="13.634"
                                                r="1.42021"
                                                transform="rotate(180 38.9138 13.634)"
                                                fill="#3056D3" />
                                        <circle cx="38.9138"
                                                cy="50.2754"
                                                r="1.42021"
                                                transform="rotate(180 38.9138 50.2754)"
                                                fill="#3056D3" />
                                        <circle cx="38.9138"
                                                cy="26.1319"
                                                r="1.42021"
                                                transform="rotate(180 38.9138 26.1319)"
                                                fill="#3056D3" />
                                        <circle cx="38.9138"
                                                cy="1.42021"
                                                r="1.42021"
                                                transform="rotate(180 38.9138 1.42021)"
                                                fill="#3056D3" />
                                        <circle cx="26.4157"
                                                cy="87.4849"
                                                r="1.42021"
                                                transform="rotate(180 26.4157 87.4849)"
                                                fill="#3056D3" />
                                        <circle cx="26.4157"
                                                cy="74.9871"
                                                r="1.42021"
                                                transform="rotate(180 26.4157 74.9871)"
                                                fill="#3056D3" />
                                        <circle cx="26.4157"
                                                cy="62.4892"
                                                r="1.42021"
                                                transform="rotate(180 26.4157 62.4892)"
                                                fill="#3056D3" />
                                        <circle cx="26.4157"
                                                cy="38.3457"
                                                r="1.42021"
                                                transform="rotate(180 26.4157 38.3457)"
                                                fill="#3056D3" />
                                        <circle cx="26.4157"
                                                cy="13.634"
                                                r="1.42021"
                                                transform="rotate(180 26.4157 13.634)"
                                                fill="#3056D3" />
                                        <circle cx="26.4157"
                                                cy="50.2754"
                                                r="1.42021"
                                                transform="rotate(180 26.4157 50.2754)"
                                                fill="#3056D3" />
                                        <circle cx="26.4157"
                                                cy="26.1319"
                                                r="1.42021"
                                                transform="rotate(180 26.4157 26.1319)"
                                                fill="#3056D3" />
                                        <circle cx="26.4157"
                                                cy="1.4202"
                                                r="1.42021"
                                                transform="rotate(180 26.4157 1.4202)"
                                                fill="#3056D3" />
                                        <circle cx="13.9177"
                                                cy="87.4849"
                                                r="1.42021"
                                                transform="rotate(180 13.9177 87.4849)"
                                                fill="#3056D3" />
                                        <circle cx="13.9177"
                                                cy="74.9871"
                                                r="1.42021"
                                                transform="rotate(180 13.9177 74.9871)"
                                                fill="#3056D3" />
                                        <circle cx="13.9177"
                                                cy="62.4892"
                                                r="1.42021"
                                                transform="rotate(180 13.9177 62.4892)"
                                                fill="#3056D3" />
                                        <circle cx="13.9177"
                                                cy="38.3457"
                                                r="1.42021"
                                                transform="rotate(180 13.9177 38.3457)"
                                                fill="#3056D3" />
                                        <circle cx="13.9177"
                                                cy="13.634"
                                                r="1.42021"
                                                transform="rotate(180 13.9177 13.634)"
                                                fill="#3056D3" />
                                        <circle cx="13.9177"
                                                cy="50.2754"
                                                r="1.42021"
                                                transform="rotate(180 13.9177 50.2754)"
                                                fill="#3056D3" />
                                        <circle cx="13.9177"
                                                cy="26.1319"
                                                r="1.42021"
                                                transform="rotate(180 13.9177 26.1319)"
                                                fill="#3056D3" />
                                        <circle cx="13.9177"
                                                cy="1.42019"
                                                r="1.42021"
                                                transform="rotate(180 13.9177 1.42019)"
                                                fill="#3056D3" />
                                        <circle cx="1.41963"
                                                cy="87.4849"
                                                r="1.42021"
                                                transform="rotate(180 1.41963 87.4849)"
                                                fill="#3056D3" />
                                        <circle cx="1.41963"
                                                cy="74.9871"
                                                r="1.42021"
                                                transform="rotate(180 1.41963 74.9871)"
                                                fill="#3056D3" />
                                        <circle cx="1.41963"
                                                cy="62.4892"
                                                r="1.42021"
                                                transform="rotate(180 1.41963 62.4892)"
                                                fill="#3056D3" />
                                        <circle cx="1.41963"
                                                cy="38.3457"
                                                r="1.42021"
                                                transform="rotate(180 1.41963 38.3457)"
                                                fill="#3056D3" />
                                        <circle cx="1.41963"
                                                cy="13.634"
                                                r="1.42021"
                                                transform="rotate(180 1.41963 13.634)"
                                                fill="#3056D3" />
                                        <circle cx="1.41963"
                                                cy="50.2754"
                                                r="1.42021"
                                                transform="rotate(180 1.41963 50.2754)"
                                                fill="#3056D3" />
                                        <circle cx="1.41963"
                                                cy="26.1319"
                                                r="1.42021"
                                                transform="rotate(180 1.41963 26.1319)"
                                                fill="#3056D3" />
                                        <circle cx="1.41963"
                                                cy="1.4202"
                                                r="1.42021"
                                                transform="rotate(180 1.41963 1.4202)"
                                                fill="#3056D3" />
                                    </svg>
                                </span>
                            </div>
                        </div>
                    </div>
                }
            }
        </div>
    </div>
}
<section id="success" class="bg-gray-2 py-[60px] dark:bg-dark fixed bottom-0 right-1 lg:right-5 hidden z-50"
         x-data="{ toastOpen: true, timer: null }"
         x-init="timer=setTimeout(() =>
                            {
                            toastOpen = false;
                            }, 5000);
        "
         x-on:click.away="clearTimeout(timer);
                            toastOpen = false;
        "
         x-on:mouseover="clearTimeout(timer)"
         x-on:mouseout="timer = setTimeout(() => {
                            toastOpen = false;
                            }, 5000);
        "
         :class="toastOpen ? 'block' : 'hidden'">
    <div class="mx-auto px-4 sm:container">
        <div class="relative flex min-w-[350px] lg:min-w-[450px] items-center rounded-lg border border-gray-200 bg-white p-4 py-[18px] shadow-xl sm:px-[30px] dark:border-dark-3 dark:bg-dark-2 dark:shadow-box-dark">
            <div class="mr-5 flex h-10 w-full max-w-[40px] items-center justify-center rounded-full bg-[#38679D]">
                <svg width="24"
                     height="25"
                     viewBox="0 0 24 25"
                     fill="none"
                     xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 1.17499C5.7375 1.17499 0.675003 6.23749 0.675003 12.5C0.675003 18.7625 5.7375 23.8625 12 23.8625C18.2625 23.8625 23.3625 18.7625 23.3625 12.5C23.3625 6.23749 18.2625 1.17499 12 1.17499ZM12 22.175C6.675 22.175 2.3625 17.825 2.3625 12.5C2.3625 7.17499 6.675 2.86249 12 2.86249C17.325 2.86249 21.675 7.21249 21.675 12.5375C21.675 17.825 17.325 22.175 12 22.175Z"
                          fill="white" />
                    <path d="M15.225 9.01248L10.7625 13.3625L8.7375 11.375C8.4 11.0375 7.875 11.075 7.5375 11.375C7.2 11.7125 7.2375 12.2375 7.5375 12.575L9.9375 14.9C10.1625 15.125 10.4625 15.2375 10.7625 15.2375C11.0625 15.2375 11.3625 15.125 11.5875 14.9L16.425 10.25C16.7625 9.91248 16.7625 9.38748 16.425 9.04998C16.0875 8.71248 15.5625 8.71248 15.225 9.01248Z"
                          fill="white" />
                </svg>
            </div>
            <div class="flex w-full items-center justify-between">
                <div>
                    <h6 class="text-base font-semibold text-dark sm:text-lg dark:text-white">
                        Ottimo!
                    </h6>
                    <p class="text-sm text-body-color dark:text-dark-6 text-nowrap">
                        Prodotto aggiunto al carrello.
                    </p>
                </div>

                <button class="text-dark-5 hover:text-red cursor-pointer" onclick="closeSuccess()">
                    <svg width="18"
                         height="18"
                         viewBox="0 0 18 18"
                         fill="none"
                         xmlns="http://www.w3.org/2000/svg"
                         class="fill-current">
                        <path d="M9.9 9.00001L16.7625 2.13751C17.0156 1.88439 17.0156 1.49064 16.7625 1.23751C16.5094 0.984387 16.1156 0.984387 15.8625 1.23751L9 8.10001L2.1375 1.23751C1.88437 0.984387 1.49062 0.984387 1.2375 1.23751C0.984372 1.49064 0.984372 1.88439 1.2375 2.13751L8.1 9.00001L1.2375 15.8625C0.984372 16.1156 0.984372 16.5094 1.2375 16.7625C1.35 16.875 1.51875 16.9594 1.6875 16.9594C1.85625 16.9594 2.025 16.9031 2.1375 16.7625L9 9.90001L15.8625 16.7625C15.975 16.875 16.1437 16.9594 16.3125 16.9594C16.4812 16.9594 16.65 16.9031 16.7625 16.7625C17.0156 16.5094 17.0156 16.1156 16.7625 15.8625L9.9 9.00001Z" />
                    </svg>
                </button>
            </div>
        </div>
    </div>
</section>
<section id="error" class="bg-gray-2 py-[60px] dark:bg-dark fixed bottom-0 right-1 lg:right-5 hidden z-50"
         x-data="{ toastErrorOpen: true, errorTimer: null }"
         x-init="errorTimer=setTimeout(() =>
                            {
                            toastErrorOpen = false;
                            }, 5000);
        "
         x-on:click.away="clearTimeout(errorTimer);
                            toastErrorOpen = false;
        "
         x-on:mouseover="clearTimeout(errorTimer)"
         x-on:mouseout="errorTimer = setTimeout(() => {
                            toastErrorOpen = false;
                            }, 5000);
        "
         :class="toastErrorOpen ? 'block' : 'hidden'">
    <div class="mx-auto px-4 sm:container">
        <div class="relative flex min-w-[350px] lg:min-w-[450px] items-center rounded-lg border border-gray-200 bg-white p-4 py-[18px] shadow-xl sm:px-[30px] dark:border-dark-3 dark:bg-dark-2 dark:shadow-box-dark">
            <div class="mr-5 flex h-10 w-full max-w-[40px] items-center justify-center rounded-full bg-red-500">
                <svg width="24"
                     height="25"
                     viewBox="0 0 24 25"
                     fill="none"
                     xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 1.17499C5.7375 1.17499 0.675003 6.23749 0.675003 12.5C0.675003 18.7625 5.7375 23.8625 12 23.8625C18.2625 23.8625 23.3625 18.7625 23.3625 12.5C23.3625 6.23749 18.2625 1.17499 12 1.17499ZM12 22.175C6.675 22.175 2.3625 17.825 2.3625 12.5C2.3625 7.17499 6.675 2.86249 12 2.86249C17.325 2.86249 21.675 7.21249 21.675 12.5375C21.675 17.825 17.325 22.175 12 22.175Z"
                          fill="white" />
                    <path d="M15.5625 9.43751C15.3094 9.18439 14.9156 9.18439 14.6625 9.43751L12 12.1L9.3375 9.43751C9.08437 9.18439 8.69062 9.18439 8.4375 9.43751C8.18437 9.69064 8.18437 10.0844 8.4375 10.3375L11.1 13L8.4375 15.6625C8.18437 15.9156 8.18437 16.3094 8.4375 16.5625C8.55 16.675 8.71875 16.7594 8.8875 16.7594C9.05625 16.7594 9.225 16.7031 9.3375 16.5625L12 13.9L14.6625 16.5625C14.775 16.675 14.9437 16.7594 15.1125 16.7594C15.2812 16.7594 15.45 16.7031 15.5625 16.5625C15.8156 16.3094 15.8156 15.9156 15.5625 15.6625L12.9 13L15.5625 10.3375C15.8156 10.0844 15.8156 9.69064 15.5625 9.43751Z"
                          fill="white" />
                </svg>
            </div>
            <div class="flex w-full items-center justify-between">
                <div>
                    <h6 class="text-base font-semibold text-dark sm:text-lg dark:text-white">
                        Attenzione!
                    </h6>
                    <p class="text-sm text-body-color dark:text-dark-6 text-nowrap">
                        Errore durante il processo.
                    </p>
                </div>

                <button class="text-dark-5 hover:text-red cursor-pointer" onclick="closeError()">
                    <svg width="18"
                         height="18"
                         viewBox="0 0 18 18"
                         fill="none"
                         xmlns="http://www.w3.org/2000/svg"
                         class="fill-current">
                        <path d="M9.9 9.00001L16.7625 2.13751C17.0156 1.88439 17.0156 1.49064 16.7625 1.23751C16.5094 0.984387 16.1156 0.984387 15.8625 1.23751L9 8.10001L2.1375 1.23751C1.88437 0.984387 1.49062 0.984387 1.2375 1.23751C0.984372 1.49064 0.984372 1.88439 1.2375 2.13751L8.1 9.00001L1.2375 15.8625C0.984372 16.1156 0.984372 16.5094 1.2375 16.7625C1.35 16.875 1.51875 16.9594 1.6875 16.9594C1.85625 16.9594 2.025 16.9031 2.1375 16.7625L9 9.90001L15.8625 16.7625C15.975 16.875 16.1437 16.9594 16.3125 16.9594C16.4812 16.9594 16.65 16.9031 16.7625 16.7625C17.0156 16.5094 17.0156 16.1156 16.7625 15.8625L9.9 9.00001Z" />
                    </svg>
                </button>
            </div>
        </div>
    </div>
</section>

@if (ViewBag.Partner != null)
{
    <section class="bg-gray-2 py-[60px] dark:bg-dark fixed bottom-0 right-1 lg:right-5"
             x-data="{ toastParternOpen: true, timer: null }"
             x-init="timer=setTimeout(() =>
                            {
                            toastParternOpen = false;
                            }, 5000);
        "
             x-on:click.away="clearTimeout(timer);
                            toastParternOpen = false;
        "
             x-on:mouseover="clearTimeout(timer)"
             x-on:mouseout="timer = setTimeout(() => {
                            toastParternOpen = false;
                            }, 5000);
        "
             :class="toastParternOpen ? 'block' : 'hidden'">
        <div class="mx-auto px-4 sm:container">
            <div class="relative flex min-w-[350px] lg:min-w-[450px] items-center rounded-lg border border-gray-200 bg-white p-4 py-[18px] shadow-xl sm:px-[30px] dark:border-dark-3 dark:bg-dark-2 dark:shadow-box-dark">
                <div class="mr-5 flex h-10 w-full max-w-[40px] items-center justify-center rounded-full bg-[#38679D]">
                    <svg width="24"
                            height="25"
                            viewBox="0 0 24 25"
                            fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 1.17499C5.7375 1.17499 0.675003 6.23749 0.675003 12.5C0.675003 18.7625 5.7375 23.8625 12 23.8625C18.2625 23.8625 23.3625 18.7625 23.3625 12.5C23.3625 6.23749 18.2625 1.17499 12 1.17499ZM12 22.175C6.675 22.175 2.3625 17.825 2.3625 12.5C2.3625 7.17499 6.675 2.86249 12 2.86249C17.325 2.86249 21.675 7.21249 21.675 12.5375C21.675 17.825 17.325 22.175 12 22.175Z"
                                fill="white" />
                        <path d="M15.225 9.01248L10.7625 13.3625L8.7375 11.375C8.4 11.0375 7.875 11.075 7.5375 11.375C7.2 11.7125 7.2375 12.2375 7.5375 12.575L9.9375 14.9C10.1625 15.125 10.4625 15.2375 10.7625 15.2375C11.0625 15.2375 11.3625 15.125 11.5875 14.9L16.425 10.25C16.7625 9.91248 16.7625 9.38748 16.425 9.04998C16.0875 8.71248 15.5625 8.71248 15.225 9.01248Z"
                                fill="white" />
                    </svg>
                </div>
                <div class="flex w-full items-center justify-between">
                    <div>
                        <p class="text-sm text-body-color dark:text-dark-6 text-nowrap">
                            Stai scegliendo l'omaggio florale per @datiEsterni.NomeDefunto @datiEsterni.CognomeDefunto
                        </p>
                        <p class="text-sm text-body-color dark:text-dark-6 text-nowrap">
                            tramite @datiEsterni.RedirectUrl
                        </p>
                    </div>

                    <button class="text-dark-5 hover:text-red cursor-pointer" x-on:click="clearTimeout(timer); toastOpen = !toastOpen">
                        <svg width="18"
                             height="18"
                             viewBox="0 0 18 18"
                             fill="none"
                             xmlns="http://www.w3.org/2000/svg"
                             class="fill-current">
                            <path d="M9.9 9.00001L16.7625 2.13751C17.0156 1.88439 17.0156 1.49064 16.7625 1.23751C16.5094 0.984387 16.1156 0.984387 15.8625 1.23751L9 8.10001L2.1375 1.23751C1.88437 0.984387 1.49062 0.984387 1.2375 1.23751C0.984372 1.49064 0.984372 1.88439 1.2375 2.13751L8.1 9.00001L1.2375 15.8625C0.984372 16.1156 0.984372 16.5094 1.2375 16.7625C1.35 16.875 1.51875 16.9594 1.6875 16.9594C1.85625 16.9594 2.025 16.9031 2.1375 16.7625L9 9.90001L15.8625 16.7625C15.975 16.875 16.1437 16.9594 16.3125 16.9594C16.4812 16.9594 16.65 16.9031 16.7625 16.7625C17.0156 16.5094 17.0156 16.1156 16.7625 15.8625L9.9 9.00001Z" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </section>
}

<script defer>
    function addToCart(id, price, category) {
        const dto = {
            SelectedProducts: [{
                ProdottoId: id,
                Prezzo: price,
                Quantita: parseInt(1, 10),
                Categoria: category,
                SelectedDates: [],
                SelectedWeekday: '',
                NotaConsegna: '',
                NotaFiori: '',
                Messaggio: '',
                NomeDestinatario: '',
                CognomeDestinatario: '',
                Indirizzo: ''
            }]
        };

        fetch('/Cart/AddToCart', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(dto)
        })
            .then(response => {
                if (response.ok) {
                    console.log('Dati inviati con successo!');

                    const success = document.getElementById('success');
                    if (success) {
                        success.classList.remove('hidden');
                    }
                } else {
                    console.error(response);

                    const error = document.getElementById('error');
                    if (error) {
                        error.classList.remove('hidden');
                    }
                }
            })
            .catch(error => {
                console.error('Errore di rete:', error);
            });
    }

    function closeSuccess() {
        const success = document.getElementById('success');
        if (success)
            success.classList.add('hidden');
    }

    function closeError() {
        const error = document.getElementById('error');
        if (error)
            error.classList.add('hidden');
    }
</script>